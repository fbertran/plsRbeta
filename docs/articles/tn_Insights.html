<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Partial Least Squares Regression for Beta Regression Models • plsRbeta</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Partial Least Squares Regression for Beta Regression Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plsRbeta</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fbertran/plsRbeta"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Partial Least Squares Regression for Beta Regression Models</h1>
            <h3 data-toc-skip class="subtitle">The plsRbeta package</h3>
                        <h4 data-toc-skip class="author">Frédéric
Bertrand and Myriam Maumy-Bertrand</h4>
            <address class="author_afil">
      IRMA, labex IRMIA, Université de Strasbourg and CNRS. LIST3N,
Université de technologie de
Troyes.<br><a class="author_email" href="mailto:#"></a><a href="mailto:frederic.bertrand@lecnam.net" class="email">frederic.bertrand@lecnam.net</a>
      </address>
                  
            <h4 data-toc-skip class="date">2025-09-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fbertran/plsRbeta/blob/HEAD/vignettes/tn_Insights.Rmd" class="external-link"><code>vignettes/tn_Insights.Rmd</code></a></small>
      <div class="d-none name"><code>tn_Insights.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>Many variables of interest, such as experimental results, yields or
economic indicators, are naturally expressed as rates, proportions or
indices whose values are necessarily between zero and one or more
generally two fixed values known in advance. Beta regression allows us
to model these data with a great deal of flexibility, since the density
functions of the Beta laws can take on a wide variety of forms. However,
like all usual regression models, it cannot be applied directly when the
predictors present multicollinearity problems or worse when they are
more numerous than the observations. These situations are frequently
encountered in chemistry, medicine, economics or marketing. To
circumvent this difficulty, we formulate an extension of PLS regression
for Beta regression models. This, along with several tools such as
cross-validation and bootstrap techniques, is available for the
<code>R</code> language in the <code>plsRbeta</code> library.</p>
<div class="section level3">
<h3 id="keywords">Keywords<a class="anchor" aria-label="anchor" href="#keywords"></a>
</h3>
<p>Beta Regression, PLS Regression, PLS Beta Regression, Cross
validation, Bootstrap techniques, <code>R</code> language</p>
<p>Classification/MSC: 62F40, 62J07, 62J12, 62P10, 62P20, 62P30</p>
</div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>PLS regression, the result of the NIPALS algorithm initially
developed by Wold (Wold, 1966)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;H. WOLD&lt;/em&gt;. Estimation of principal component and
related models by iterative least squares. In &lt;em&gt;P.R. KRISHNAIAH&lt;/em&gt;,
editor : Multivariate Analysis, pages 391–420. Academic Press, New York,
1966.&lt;/p&gt;"><sup>1</sup></a> and explained in detail by Tenenhaus
(Tenenhaus, 1998)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;M. TENENHAUS&lt;/em&gt;. La régression PLS : Théorie et
Pratique. Technip, Paris, 1998.&lt;/p&gt;"><sup>2</sup></a>, has already been successfully extended to
generalized linear models by Bastien <em>et al.</em> (Bastien, 2005)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;Ph. BASTIEN, V. ESPOSITO VINZI et M. TENENHAUS&lt;/em&gt;.
Pls generalised linear regression. Computational Statistics &amp;amp; Data
Analysis, 48(1):17–46, 2005.&lt;/p&gt;"><sup>3</sup></a> and to Cox
models by Bastien (Bastien 2008)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;Ph. BASTIEN&lt;/em&gt;. Deviance residuals based PLS
regression for censored data in high dimensional setting. Chemometrics
and Intelligent Laboratory Systems, 91(1):78–86, 2008.&lt;/p&gt;"><sup>4</sup></a> and (Bastien 2015)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;Ph. BASTIEN, F. BERTRAND, N. MEYER and M.
MAUMY-BERTRAND&lt;/em&gt;. Deviance residuals based sparse PLS and sparse
kernel PLS regression for censored data. Bioinformatics, 31(3):397–404,
2015.&lt;/p&gt;"><sup>5</sup></a>.</p>
<p>We proposed an extension of PLS regression to Beta regression models
in Bertrand (2013)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;F. BERTRAND, N. MEYER, M. BEAU-FALLER, K. EL BAYED,
I.-J. NAMER, M. MAUMY-BERTRAND&lt;/em&gt;. Régression Bêta PLS. (French) [PLS
Beta regression.]. J. SFdS, 154(3):143–159, 2013.&lt;/p&gt;"><sup>6</sup></a>. Indeed, the practical interest of the Beta
distribution had been asserted several times, for example by Johnson
<em>et al.</em> (Johnson, 1995)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;N.L. JOHNSON, S. KOTZ et N. BALAKRISHNAN&lt;/em&gt;.
Continuous Univariate Distributions, volume 2. Wiley, New York, 2nd
edition, 1995.&lt;/p&gt;"><sup>7</sup></a> :</p>
<p>“Beta distributions are very versatile and a variety of uncertanties
can be usefully modelled by them. This flexibility encourages its
empirical use in a wide range of applications.”</p>
<p>Several articles have focused on the study of Beta regression and its
properties. Let us mention in particular, the article by Ferrari and
Cribari-Neto (Ferrari, 2004)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;S.L.P. FERRARI, et F. CRIBARI-NETO&lt;/em&gt;. Beta
Regression for Modeling Rates and Proportions. Journal of Applied
Statistics, 31(7):799–815, 2004.&lt;/p&gt;"><sup>8</sup></a> for an introduction to these models and
those by Kosmidis and Firth (Kosmidis, 2010)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;I. KOSMIDIS et D. FIRTH&lt;/em&gt;. A Generic Algorithm
for Reducing Bias in Parametric Estimation. Journal of Chemometrics,
4:1097–1112, 2010.&lt;/p&gt;"><sup>9</sup></a>, Simas <em>et al.</em>
(Simas, 2010)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;A.B. SIMAS,W. BARRETO-SOUZA et A.V. ROCHA&lt;/em&gt;.
Improved Estimators for a General Class of Beta Regression Models.
Computational Statistics &amp;amp; Data Analysis, 54(2):348–366, 2010.&lt;/p&gt;"><sup>10</sup></a> and Grün <em>et al.</em> (Grün, 2012)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;B. GRÜN, I. KOSMIDIS et A. ZEILEIS&lt;/em&gt;. Extended
Beta Regression in R : Shaken, Stirred, Mixed and Partitioned. Journal
of Statistical Software, 48(11):1–25, 2012.&lt;/p&gt;"><sup>11</sup></a> for
extensions or improvements of the estimation techniques of these
models.</p>
<p>We will assume in the rest of the paper that the answer studied has
values in the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>;</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0;1]</annotation></semantics></math>.
The model we propose can of course be used as soon as the answer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
has values in a bounded interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>;</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[a;b]</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a&lt;b</annotation></semantics></math>
fixed and known, by studying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(Y-a)/(b-a)</annotation></semantics></math>
instead of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="pls-beta-regression">PLS Beta Regression<a class="anchor" aria-label="anchor" href="#pls-beta-regression"></a>
</h2>
<div class="section level3">
<h3 id="beta-regression">Beta Regression<a class="anchor" aria-label="anchor" href="#beta-regression"></a>
</h3>
<p>When it is non-zero, the density function of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textrm{Beta}(p,q)</annotation></semantics></math>
law is given by :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>;</mo><mi>p</mi><mo>;</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>y</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mspace width="1.0em"></mspace><mn>0</mn><mo>&lt;</mo><mi>y</mi><mo>&lt;</mo><mn>1</mn><mspace width="1.0em"></mspace><mtext mathvariant="normal">(E.1)</mtext></mrow><annotation encoding="application/x-tex">\begin{equation}
\pi(y;p;q)=\frac{\Gamma(p+q)}{\Gamma(p)\Gamma(q)}y^{p-1}(1-y)^{q-1}, \quad 0&lt;y&lt;1 \quad \textrm{(E.1)}
\end{equation}</annotation></semantics></math> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p&gt;0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">q&gt;0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma(\cdot)</annotation></semantics></math>
the Euler gamma function. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
follows a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textrm{Beta}(p,q)</annotation></semantics></math>
distribution, its expectation and variance are equal to :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>p</mi><mrow><mi>p</mi><mo>+</mo><mi>q</mi></mrow></mfrac><mspace width="1.0em"></mspace><mtext mathvariant="normal">et</mtext><mspace width="1.0em"></mspace><mrow><mi mathvariant="normal">V</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mi>q</mi></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>⋅</mo><mspace width="1.0em"></mspace><mtext mathvariant="normal">(E.2)</mtext></mrow><annotation encoding="application/x-tex">\begin{equation}
\mathbb{E}(Y)=\frac{p}{p+q} \quad \textrm{et} \quad \mathrm{Var}(Y)=\frac{pq}{(p+q)^2(p+q+1)}\cdot \quad \textrm{(E.2)}
\end{equation}</annotation></semantics></math> In order to be able to
apply techniques similar to those used for generalized linear models by
McCullagh and Nelder, Ferrari and Cribari-Neto (Ferrari, 2004)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;S.L.P. FERRARI, et F. CRIBARI-NETO&lt;/em&gt;. Beta
Regression for Modeling Rates and Proportions. Journal of Applied
Statistics, 31(7):799–815, 2004.&lt;/p&gt;"><sup>12</sup></a> propose
to rephrase the Beta law as follows. By posing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mi>p</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu=p/(p+q)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mi>p</mi><mo>+</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">\phi=p+q</annotation></semantics></math>,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>μ</mi><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">p=\mu\phi</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">q=(1-\mu)\phi</annotation></semantics></math>,
the Equation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">E.2</mtext><annotation encoding="application/x-tex">\textrm{E.2}</annotation></semantics></math>)
becomes :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>μ</mi><mspace width="1.0em"></mspace><mtext mathvariant="normal">et</mtext><mspace width="1.0em"></mspace><mrow><mi mathvariant="normal">V</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mi>ϕ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\mathbb{E}(Y)=\mu \quad \textrm{et} \quad \mathrm{Var}(Y)=\frac{V(\mu)}{1+\phi}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>μ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V(\mu)=\mu(1-\mu)</annotation></semantics></math>.
Thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is the mean value of the response and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
can be interpreted as a precision parameter since, for a fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,
the higher the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>,
the smaller the variance of the response. With these new parameters, the
density function given in Equation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">E.1</mtext><annotation encoding="application/x-tex">\textrm{E.1}</annotation></semantics></math>)
is equal to :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>;</mo><mi>μ</mi><mo>;</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>y</mi><mrow><mi>μ</mi><mi>ϕ</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>ϕ</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mspace width="1.0em"></mspace><mn>0</mn><mo>&lt;</mo><mi>y</mi><mo>&lt;</mo><mn>1</mn><mi>.</mi><mspace width="1.0em"></mspace><mtext mathvariant="normal">(E.3)</mtext></mrow><annotation encoding="application/x-tex">\begin{equation}
\pi(y;\mu;\phi)=\frac{\Gamma(\phi)}{\Gamma(\mu\phi)\Gamma((1-\mu)\phi)}y^{\mu\phi-1}(1-y)^{(1-\mu)\phi-1}, \quad 0&lt;y&lt;1. \quad \textrm{(E.3)}
\end{equation}</annotation></semantics></math></p>
<p>It is not possible to apply directly the theory of the generalized
linear model, as introduced by the founding article of Nelder and
Wedderburn (Nelder, 1972)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;J. NELDER et R. WEDDERBURN&lt;/em&gt;. Generalized Linear
Models. Journal of the Royal Statistical Society. Series A (General),
135(3):370–384, 1972.&lt;/p&gt;"><sup>13</sup></a> and then taken up again in the eponymous
book of McCullagh and Nelder (McCullagh, 1995)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;P. MCCULLAGH et J.A. NELDER&lt;/em&gt;. Generalized
Linear Models. Chapman &amp;amp; Hall/CRC, Boca Raton, 2nd édition, 1995.&lt;/p&gt;"><sup>14</sup></a>, because it is based
on the use of a family of laws put in natural exponential form (NEF).
However, as indicated by Morris (Morris, 1982)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;C.N. MORRIS&lt;/em&gt;. Natural exponential families with
quadratic variance functions. The Annals of Statistics, 10:65–80,
1982.&lt;/p&gt;"><sup>15</sup></a>, the family of beta
laws, with the parameterization taken up by Ferrari and Cribari-Neto
(Ferrari, 2004)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;S.L.P. FERRARI, et F. CRIBARI-NETO&lt;/em&gt;. Beta
Regression for Modeling Rates and Proportions. Journal of Applied
Statistics, 31(7):799–815, 2004.&lt;/p&gt;"><sup>16</sup></a> and introduced above, is certainly a
univariate exponential family but not a natural exponential family.
Indeed, the latter are characterized by their variance function. But the
variance function of this parameterization of the family of beta laws is
already that of the natural exponential family formed by the binomial
laws, hence the result. For the same reason, it is not possible to
characterize, within the exponential families, the family of Beta
distributions by means of their variance function.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>…</mi><annotation encoding="application/x-tex">\ldots</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>n</mi></msub><annotation encoding="application/x-tex">Y_n</annotation></semantics></math>
be independent random variables distributed according to the density
function given in Equation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">E.3</mtext><annotation encoding="application/x-tex">\textrm{E.3}</annotation></semantics></math>)
of mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mu_t</annotation></semantics></math>
and unknown precision
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>.</p>
<p>We obtain the Beta regression model by assuming that the mean of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">Y_t</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1\leqslant t\leqslant n</annotation></semantics></math>,
can be written :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>x</mi><mrow><mi>t</mi><mi>i</mi></mrow></msub><msub><mi>β</mi><mi>i</mi></msub><mo>=</mo><msub><mi>η</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
g(\mu_t)=\sum_{i=1}^kx_{ti}\beta_i=\eta_k
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>β</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">\beta=(\beta_1,\ldots,\beta_k)'</annotation></semantics></math>
is a vector of unknown regression parameters
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">\beta \in \mathbb{R}^k</annotation></semantics></math>),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>′</mi><annotation encoding="application/x-tex">'</annotation></semantics></math>
denoting the matrix transpose, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>t</mi><mn>1</mn><mo>,</mo></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>t</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{t1,},\ldots,x_{tk}</annotation></semantics></math>
are the observations of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
predictors with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">k&lt;n</annotation></semantics></math>
that are assumed to be known and fixed. Finally,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>
is a strictly monotone, twice derivable, surjective link function
defined on the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">]</mo><mn>0</mn><mo>;</mo><mn>1</mn><mo stretchy="false" form="prefix">[</mo></mrow><annotation encoding="application/x-tex">]0;1[</annotation></semantics></math>
and with values in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℝ</mi><annotation encoding="application/x-tex">\mathbb{R}</annotation></semantics></math>.
The variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">Y_t</annotation></semantics></math>
is a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mu_t</annotation></semantics></math>
and thus depends on the value of the covariates. Therefore, the model
automatically takes into account the possible lack of
homoscedasticity.</p>
<p>There are several common choices for the link function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>.
For example, the logit link
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mi>μ</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">g(\mu)=\log{\mu/(1-\mu)}</annotation></semantics></math>,
the probit link
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>Φ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\mu)=\Phi^{-1}(\mu)</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
the distribution function of the centered and reduced normal
distribution, the complementary log-log link
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(\mu)=-\log(1-\mu))</annotation></semantics></math>,
the log-log link
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\mu)=-\log(-\log(\mu))</annotation></semantics></math>.
A detailed study of these links has been made by McCullagh and Nelder
(McCullagh, 1995)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;P. MCCULLAGH et J.A. NELDER&lt;/em&gt;. Generalized
Linear Models. Chapman &amp;amp; Hall/CRC, Boca Raton, 2nd édition, 1995.&lt;/p&gt;"><sup>17</sup></a> and Atkinson (Atkinson, 1985)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;A.C. ATKINSON&lt;/em&gt;. Plots, Transformations and
Regression : An Introduction to Graphical Methods of Diagnostic
Regression Analysis. Oxford University Press, Oxford, 1985.&lt;/p&gt;"><sup>18</sup></a> has
proposed others. As usual, the use of the logit link makes it possible
to interpret the exponential of the coefficients of the covariates in
terms of the odds ratio.</p>
</div>
<div class="section level3">
<h3 id="pls-regression">PLS Regression<a class="anchor" aria-label="anchor" href="#pls-regression"></a>
</h3>
<p>Consider the centered variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>,
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>,
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>p</mi></msub><annotation encoding="application/x-tex">x_p</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
be the matrix of predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>,
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>,
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>p</mi></msub><annotation encoding="application/x-tex">x_p</annotation></semantics></math>.
PLS regression is well known and exhaustively described by Höskuldsson
(Höskuldsson, 1988)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;A. HÖSKULDSSON&lt;/em&gt;. PLS regression methods.
Journal of Chemometrics, 2:211–228, 1988.&lt;/p&gt;"><sup>19</sup></a>, Wold <em>et al.</em> (Wold, 2001)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;S. WOLD, M. SJÖSTRÖM et L. ERIKSSON&lt;/em&gt;.
PLS-regression : a basic tool of Chemometrics. Chemometrics and
Intelligent Laboratory Systems, 58:109–130, 2001.&lt;/p&gt;"><sup>20</sup></a> and
Tenenhaus (Tenenhaus, 1998)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;M. TENENHAUS&lt;/em&gt;. La régression PLS : Théorie et
Pratique. Technip, Paris, 1998.&lt;/p&gt;"><sup>21</sup></a>. The classical presentation of PLS
regression is in algorithmic form. We will only recall the elements that
are useful for the following. PLS regression is a non-linear model which
allows to construct orthogonal components
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>h</mi></msub><annotation encoding="application/x-tex">t_h</annotation></semantics></math>
obtained by maximizing the quantities
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>v</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>,</mo><msub><mi>t</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">cov(Y,t_h)</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
be the matrix formed by these components, we have :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Y</mi><mo>=</mo><mi>T</mi><mi>c</mi><mi>′</mi><mo>+</mo><mi>ϵ</mi><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{eqnarray}
Y = Tc' + \epsilon,
\end{eqnarray}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math>
is the vector of residuals and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">c'</annotation></semantics></math>
is the vector of component coefficients. By positing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mi>X</mi><msup><mi>W</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">T=XW^*</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>W</mi><mo>*</mo></msup><annotation encoding="application/x-tex">W^*</annotation></semantics></math>
is the matrix of the coefficients of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
variables in each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>h</mi></msub><annotation encoding="application/x-tex">t_h</annotation></semantics></math>
component, we have the direct expression for the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
using the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
predictors:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Y</mi><mo>=</mo><mi>X</mi><msup><mi>W</mi><mo>*</mo></msup><mi>c</mi><mi>′</mi><mo>+</mo><mi>ϵ</mi><mi>.</mi><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">E.4</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{eqnarray}
Y = X W^*c' + \epsilon.\quad (\textrm{E.4})
\end{eqnarray}</annotation></semantics></math> Expanding the right-hand
side of
Equation~(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">E.4</mtext><annotation encoding="application/x-tex">\textrm{E.4}</annotation></semantics></math>),
we obtain for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
component of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>H</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>h</mi></msub><msubsup><mi>w</mi><mrow><mn>1</mn><mi>h</mi></mrow><mo>*</mo></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>h</mi></msub><msubsup><mi>w</mi><mrow><mi>p</mi><mi>h</mi></mrow><mo>*</mo></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{eqnarray}
Y_i = \sum_{h=1}^H \left(c_hw_{1h}^*x_{i1} + c_hw_{ph}^*x_{ip} \right) + \epsilon_i,
\end{eqnarray}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
being the number of components retained in the final model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>≤</mo><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H \leqslant \mathrm{rg}(X)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
being in general much lower than the rank of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
being equal to the number of variables contained in the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.
The coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>h</mi></msub><msubsup><mi>w</mi><mrow><mi>j</mi><mi>h</mi></mrow><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">c_hw^*_{jh}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \leqslant j \leqslant p</annotation></semantics></math>,
following the notation with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>*</mi><annotation encoding="application/x-tex">*</annotation></semantics></math>
of Wold <em>et al.</em> (Wold, 2001)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;S. WOLD, M. SJÖSTRÖM et L. ERIKSSON&lt;/em&gt;.
PLS-regression : a basic tool of Chemometrics. Chemometrics and
Intelligent Laboratory Systems, 58:109–130, 2001.&lt;/p&gt;"><sup>22</sup></a>, translate the relation between the
vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
and the variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
through the components
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>h</mi></msub><annotation encoding="application/x-tex">t_h</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="pls-beta-regression-1">PLS Beta Regression<a class="anchor" aria-label="anchor" href="#pls-beta-regression-1"></a>
</h3>
<p>PLS Beta Regression of the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
on the variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>,
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>,
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>p</mi></msub><annotation encoding="application/x-tex">x_p</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
components
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>h</mi></msub><mo>=</mo><msubsup><mi>w</mi><mrow><mn>1</mn><mi>h</mi></mrow><mo>*</mo></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>+</mo><mi>⋯</mi><mo>+</mo><msubsup><mi>w</mi><mrow><mi>p</mi><mi>h</mi></mrow><mo>*</mo></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_h=w^*_{1h}x_{i1}+\cdots+w^*_{ph}x_{ip}</annotation></semantics></math>
is written :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>H</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>h</mi></msub><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msubsup><mi>w</mi><mrow><mi>j</mi><mi>h</mi></mrow><mo>*</mo></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{eqnarray}
g(\mu) = \sum_{h=1}^H \left(c_h \sum_{j=1}^p w_{jh}^*x_{ij}\right),
\end{eqnarray}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">mu</annotation></semantics></math>
is the expectation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.
The link
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>
is to be chosen among the links logit, probit, complementary log-log,
log-log, Cauchit and log according to the type of data and the quality
of the model fit to the data.</p>
<hr>
<p>The algorithm for determining the PLS
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>h</mi></msub><annotation encoding="application/x-tex">t_h</annotation></semantics></math>
components of a Beta PLS regression model is as follows:</p>
<ul>
<li>Compute the first PLS component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math>
:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Compute the coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{1j}</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
in the Beta regression of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
for each predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \leqslant j \leqslant p</annotation></semantics></math>.</li>
<li>Norm the column vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>1</mn></msub><annotation encoding="application/x-tex">a_1</annotation></semantics></math>
:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mi>/</mi><mo stretchy="false" form="postfix">∥</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">∥</mo></mrow><annotation encoding="application/x-tex">w_1=a_1/\| a_1\|</annotation></semantics></math>.</li>
<li>Compute the component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mi>′</mi><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>X</mi><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">t_1=1/(w_1'w_1)Xw_1</annotation></semantics></math>.</li>
</ol>
<ul>
<li>Compute the second PLS component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math>
:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Compute the coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{2j}</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
in the Beta regression of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
for each predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \leqslant j \leqslant p</annotation></semantics></math>.</li>
<li>Norm the column vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>2</mn></msub><annotation encoding="application/x-tex">a_2</annotation></semantics></math>
:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><mi>/</mi><mo stretchy="false" form="postfix">∥</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">∥</mo></mrow><annotation encoding="application/x-tex">w_2=a_2/\| a_2\|</annotation></semantics></math>.</li>
<li>Compute the residual matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
of the linear regression of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math>.</li>
<li>Compute the component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>2</mn></msub><mi>′</mi><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>X</mi><mn>1</mn></msub><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">t_2=1/(w_2'w_2)X_1w_2</annotation></semantics></math>.</li>
<li>Express the component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math>
in terms of predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>2</mn></msub><mo>=</mo><mi>X</mi><msubsup><mi>w</mi><mn>2</mn><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">t_2=Xw^*_2</annotation></semantics></math>.</li>
</ol>
<ul>
<li>We assume having constructed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h-1</annotation></semantics></math>
components
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">t_{h-1}</annotation></semantics></math>.
We then compute the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>−</mo></mrow><annotation encoding="application/x-tex">h-</annotation></semantics></math>th
PLS component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>h</mi></msub><annotation encoding="application/x-tex">t_h</annotation></semantics></math>:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Compute the coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>h</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{hj}</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
in the Beta regression model of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math>,
$t_ldots,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">t_{h-1}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>
for each predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \leqslant j \leqslant p</annotation></semantics></math>.</li>
<li>Normalize the column vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>h</mi></msub><annotation encoding="application/x-tex">a_h</annotation></semantics></math>
:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>h</mi></msub><mo>=</mo><msub><mi>a</mi><mi>h</mi></msub><mi>/</mi><mo stretchy="false" form="postfix">∥</mo><msub><mi>a</mi><mi>h</mi></msub><mo stretchy="false" form="postfix">∥</mo></mrow><annotation encoding="application/x-tex">w_h=a_h/\| a_h\|</annotation></semantics></math>.</li>
<li>Compute the residual matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">X_{h-1}</annotation></semantics></math>
of the linear regression of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>2</mn></msub><annotation encoding="application/x-tex">t_2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">t_{h-1}</annotation></semantics></math>.</li>
<li>Compute the component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>h</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>h</mi></msub><mi>′</mi><msub><mi>w</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>X</mi><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>w</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">t_h=1/(w_h'w_h)X_{h-1}w_h</annotation></semantics></math>.</li>
<li>Express the component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>h</mi></msub><annotation encoding="application/x-tex">t_h</annotation></semantics></math>
in terms of predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>h</mi></msub><mo>=</mo><mi>X</mi><msubsup><mi>w</mi><mi>h</mi><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">t_h=Xw^*_h</annotation></semantics></math>.</li>
</ol>
<hr>
<div class="section level5">
<h5 id="proposition">Proposition<a class="anchor" aria-label="anchor" href="#proposition"></a>
</h5>
<p>The PLS components
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mo>≤</mo><mi>h</mi><mo>≤</mo><mi>H</mi></mrow></msub><annotation encoding="application/x-tex">(t_h)_{1 \leqslant h \leqslant H}</annotation></semantics></math>
are orthogonal.</p>
<hr>
<p>It is easy to modify the previous algorithm to be able to handle
incomplete datasets (Tenenhaus, 1998)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;M. TENENHAUS&lt;/em&gt;. La régression PLS : Théorie et
Pratique. Technip, Paris, 1998.&lt;/p&gt;"><sup>23</sup></a>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="bootstrap-techniques-cross-validation-and-software-implementation">Bootstrap techniques, cross-validation and software
implementation<a class="anchor" aria-label="anchor" href="#bootstrap-techniques-cross-validation-and-software-implementation"></a>
</h2>
<div class="section level3">
<h3 id="bootstrap-techniques">Bootstrap techniques<a class="anchor" aria-label="anchor" href="#bootstrap-techniques"></a>
</h3>
<p>We assume that we have retained the appropriate number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
of components of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
Beta PLS regression model on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>,
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>,
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>p</mi></msub><annotation encoding="application/x-tex">x_p</annotation></semantics></math>.
We propose the following algorithm to construct confidence intervals and
significance tests for the predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>j</mi></msub><annotation encoding="application/x-tex">x_j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \leqslant j \leqslant p</annotation></semantics></math>,
using bootstrap techniques. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="false" form="prefix">|</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">\widehat{F}_{(T|Y)}</annotation></semantics></math>
be the empirical distribution function given the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
formed by the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
PLS components and the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.</p>
<ul>
<li>
<em>Step 1.</em> Draw
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
samples from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="false" form="prefix">|</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">\widehat{F}_{(T|Y)}</annotation></semantics></math>.</li>
<li>
<em>Step 2.</em> For all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">b=1,\ldots,B</annotation></semantics></math>,
calculate :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow></mrow><mi>′</mi><msup><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup><msup><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow></mrow><mi>′</mi><msup><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mspace width="1.0em"></mspace><mtext mathvariant="normal">and</mtext><mspace width="1.0em"></mspace><msup><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mo>*</mo></msup><msup><mrow><mi>c</mi><mi>′</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
c^{(b)}=(T^{(b)}{}'T^{(b)})^{-1}T^{(b)}{}'Y^{(b)} \quad \mbox{and} \quad b^{(b)}=W^*{c'}^{(b)},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><msup><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[T^{(b)},Y^{(b)}]</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>−</mo></mrow><annotation encoding="application/x-tex">b-</annotation></semantics></math>th
bootstrap sample,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mi>c</mi><mi>′</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">{c'}^{(b)}</annotation></semantics></math>
is the vector of component coefficients and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">b^{(b)}</annotation></semantics></math>
is the vector of coefficients of the original
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
predictors for this sample and finally
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>W</mi><mo>*</mo></msup><annotation encoding="application/x-tex">W^*</annotation></semantics></math>
is the fixed matrix of the weights of the predictors in the original
model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components.</li>
<li>
<em>Step 3.</em> For each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><msub><mi>b</mi><mi>j</mi></msub></msub><annotation encoding="application/x-tex">\phi_{b_j}</annotation></semantics></math>
be the Monte Carlo approximation of the distribution function of the
bootstrap statistic of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>j</mi></msub><annotation encoding="application/x-tex">b_j</annotation></semantics></math>.
For each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>j</mi></msub><annotation encoding="application/x-tex">b_j</annotation></semantics></math>,
whisker boxes and confidence intervals can be constructed using the
percentiles of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><msub><mi>b</mi><mi>j</mi></msub></msub><annotation encoding="application/x-tex">\Phi_{b_j}</annotation></semantics></math>.
A confidence interval can be defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo stretchy="false" form="postfix">]</mo><msubsup><mi>Φ</mi><msub><mi>b</mi><mi>j</mi></msub><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msubsup><mi>Φ</mi><msub><mi>b</mi><mi>j</mi></msub><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">[</mo></mrow><annotation encoding="application/x-tex">I_j(\alpha)=]\Phi^{-1}_{b_j}(\alpha), \Phi^{-1}_{b_j}(1-\alpha)[</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Φ</mi><msub><mi>b</mi><mi>j</mi></msub><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi^{-1}_{b_j}(\alpha)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Φ</mi><msub><mi>b</mi><mi>j</mi></msub><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi^{-1}_{b_j}(1-\alpha)</annotation></semantics></math>
are the values obtained from the distribution function of the bootstrap
statistic such that a nominal level of confidence of level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>%</mi></mrow><annotation encoding="application/x-tex">100(1-2\alpha)\%</annotation></semantics></math>
is reached. In order to improve the quality of the confidence interval
in terms of coverage rates, i.e., the ability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_j(\alpha)</annotation></semantics></math>
to provide the expected coverage rates, it is possible to use several
construction techniques: normal, percentile, or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
(Efron 1993)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;B. EFRON et R.J. TIBSHIRANI&lt;/em&gt;. An Introduction
to the Bootstrap. Chapman &amp;amp; Hall, New York, 1993.&lt;/p&gt;"><sup>24</sup></a> or (Davison 1997)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;A.C. DAVISON et D.V. HINKLEY&lt;/em&gt;. Bootstrap
methods and their application. Cambridge University Press, Cambridge,
1997.&lt;/p&gt;"><sup>25</sup></a>. The resulting
intervals are not intended to be used for multiple or pairwise
comparisons and should be interpreted separately.</li>
</ul>
</div>
<div class="section level3">
<h3 id="strengths-of-the-software-implementation">Strengths of the software implementation<a class="anchor" aria-label="anchor" href="#strengths-of-the-software-implementation"></a>
</h3>
<p>The <code>plsRbeta</code> function library for the <code>R</code>
language implements PLS Beta regression models. It uses the Beta
regression implemented in the <code>betareg</code> (Cribari-Neto,
2010)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;F. CRIBARI-NETO and A. ZEILEIS&lt;/em&gt;. Beta
Regression in R. Journal of Statistical Software, 34(2):1–24, 2010.&lt;/p&gt;"><sup>26</sup></a>
function library for the <code>R</code> language to perform the
step.</p>
<ul>
<li>Beta PLS regression models with complete or incomplete data.</li>
<li>Choice of the number of components thanks to different criteria AIC,
BIC, modified
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>,
stop of significance of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">t_{m+1}</annotation></semantics></math>
component when none of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">a_{m+1}</annotation></semantics></math>
coefficients is significant in the model at a given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">alpha'</annotation></semantics></math>
level or by using a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mn>2</mn></msup><annotation encoding="application/x-tex">Q^2</annotation></semantics></math>
criterion estimated by cross validation.</li>
<li>Repeated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-fold
cross-validation with complete or incomplete data. Tables 3 and 5 are
examples of using cross-validation to determine the appropriate number
of components.</li>
<li>Bootstrapping predictor coefficients for Beta PLS regression models
with complete or incomplete data. Various interval constructions,
detailed in Efron and Tibshirani (Efron, 1993)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;B. EFRON et R.J. TIBSHIRANI&lt;/em&gt;. An Introduction
to the Bootstrap. Chapman &amp;amp; Hall, New York, 1993.&lt;/p&gt;"><sup>27</sup></a> or Davison and
Hinkley (Davison, 1997)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;A.C. DAVISON et D.V. HINKLEY&lt;/em&gt;. Bootstrap
methods and their application. Cambridge University Press, Cambridge,
1997.&lt;/p&gt;"><sup>28</sup></a>, are available and are based on the
<code>boot</code> (Canty, 2021)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;A. CANTY and B. RIPLEY&lt;/em&gt;. boot: Bootstrap R
(S-Plus) Functions. R package version 1.3-26, 2021.&lt;/p&gt;"><sup>29</sup></a> function library for the <code>R</code>
language. Figure 5 is an example of whisker boxes constructed from the
bootstrap distribution of the coefficients of the predictors of a PLS
Beta regression model. Figures 2, 3, and 6 are examples of using
bootstrap techniques to establish the significance of the predictors of
a PLS Beta regression model.</li>
</ul>
</div>
<div class="section level3">
<h3 id="selecting-the-number-of-components">Selecting the number of components<a class="anchor" aria-label="anchor" href="#selecting-the-number-of-components"></a>
</h3>
<p>A crucial problem for the correct use of PLS regression is the
determination of the number of components. If, in the case of the
original PLS regression, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mn>2</mn></msup><annotation encoding="application/x-tex">Q^2</annotation></semantics></math>
criterion is extremely efficient, its good properties unfortunately
disappear for the PLS generalized linear regression models. A simulation
study is therefore necessary to determine a functional criterion to
choose the number of components. We propose to compare the following
criteria
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">AIC</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BIC</annotation></semantics></math>
(Cribari-Neto, 2010)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;F. CRIBARI-NETO and A. ZEILEIS&lt;/em&gt;. Beta
Regression in R. Journal of Statistical Software, 34(2):1–24, 2010.&lt;/p&gt;"><sup>30</sup></a>, Pearson’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>,
Pearson’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
and
pseudo-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
(Ferrari, 2004)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;S.L.P. FERRARI, et F. CRIBARI-NETO&lt;/em&gt;. Beta
Regression for Modeling Rates and Proportions. Journal of Applied
Statistics, 31(7):799–815, 2004.&lt;/p&gt;"><sup>31</sup></a> or cumulative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Q^2\chi^2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Q^2\chi^2</annotation></semantics></math>
criteria estimated by 5-group cross-validation (5-CV) or 10-group
cross-validation (10-CV) (Bastien, 2005)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;Ph. BASTIEN, V. ESPOSITO VINZI et M.
TENENHAUS&lt;/em&gt;. Pls generalised linear regression. Computational
Statistics &amp;amp; Data Analysis, 48(1):17–46, 2005.&lt;/p&gt;"><sup>32</sup></a>.</p>
<p>The following parameters were used for the simulation design.</p>
<ul>
<li>Number of individuals: 25, 50 and 100.</li>
<li>Number of variables: 10, 25, 50 and 100.</li>
<li>Number of components: 2, 4 and 6.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
dispersion : 2,5, 5, 10 and 15.</li>
</ul>
<p>The algorithm used to create the simulated data is a direct
adaptation of the algorithm of Li <em>et al.</em> (Li, 2002)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;B. LI, J. MORRIS et E.B. MARTIN&lt;/em&gt;. Model
selection for partial least squares regression. Chemometrics and
Intelligent Laboratory Systems, 64:79–89, 2002.&lt;/p&gt;"><sup>33</sup></a> which
is itself a multivariate generalization of that of Naes and Martens
(Naes, 1985)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;T. NAES et H. MARTENS&lt;/em&gt;. Comparison of
prediction methods for multicollinear data. Communications in Statistics
– Simulation and Computation, 14:545–576, 1985.&lt;/p&gt;"><sup>34</sup></a>. This type of generalization has already
been used successfully in the case of PLS logistic regression models
(Meyer, 2010)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;N. MEYER, M. MAUMY-BERTRAND et F. BERTRAND&lt;/em&gt;.
Comparaison de variantes de régressions logistiques PLS et de régression
PLS sur variables qualitatives : application aux donnés d’allélotypage.
Journal de la Société Française De Statistique, 151(2):1–18, 2010.&lt;/p&gt;"><sup>35</sup></a>.</p>
<p>Table 1 is an example of a result for 25 individuals, 10 variables, 2
components and a dispersion parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
equal to 2.5. For 100 simulated data sets, a maximum number of 6
components had to be calculated. The average number of components that
could actually be computed, as well as the number of complete failures
of the beta regression model fit are shown in Table 2. The abbreviations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">ML</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">BR</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
indicate that the Beta regressions used to fit the Beta PLS regression
are based on maximum likelihood, bias reduction, or bias correction
(Kosmidis, 2010)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;I. KOSMIDIS et D. FIRTH&lt;/em&gt;. A Generic Algorithm
for Reducing Bias in Parametric Estimation. Journal of Chemometrics,
4:1097–1112, 2010.&lt;/p&gt;"><sup>36</sup></a>. The prefixes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">K5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn></mrow><annotation encoding="application/x-tex">K10</annotation></semantics></math>
mean that the value was obtained after cross-validation in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">K=5</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">K=10</annotation></semantics></math>
groups.</p>
<table style="width:100%;" class="table">
<caption>Table 1. Choice of the number of components per simulation.
Target value 2.</caption>
<colgroup>
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th>Criterion</th>
<th>Mean</th>
<th>SD</th>
<th>Median</th>
<th>MAD</th>
<th>Criterion</th>
<th>Mean</th>
<th>SD</th>
<th>Median</th>
<th>MAD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi><mi>.</mi><mi>A</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">ML.AIC</annotation></semantics></math></td>
<td>3.53</td>
<td>0.94</td>
<td>3.5</td>
<td>0.74</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>M</mi><mi>L</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.ML.\chi^2</annotation></semantics></math></td>
<td>2.86</td>
<td>2.05</td>
<td>2</td>
<td>1.48</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi><mi>.</mi><mi>B</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">ML.BIC</annotation></semantics></math></td>
<td>3.1</td>
<td>0.8</td>
<td>3</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>M</mi><mi>L</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msubsup><mi>χ</mi><mtext mathvariant="normal">cum</mtext><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">K10.ML.Q^2\chi^2_{\textrm{cum}}</annotation></semantics></math></td>
<td>4.71</td>
<td>1.97</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">ML.\chi^2</annotation></semantics></math></td>
<td>2.84</td>
<td>2.05</td>
<td>2</td>
<td>1.48</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>M</mi><mi>L</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.ML.Q^2\chi^2</annotation></semantics></math></td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi><mi>.</mi><mi>R</mi><mi>S</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">ML.RSS</annotation></semantics></math></td>
<td>5.15</td>
<td>1.31</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>M</mi><mi>L</mi><mi>.</mi><mtext mathvariant="normal">pre</mtext><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.ML.\textrm{pre}\chi^2</annotation></semantics></math></td>
<td>1.37</td>
<td>0.49</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi><mi>.</mi><mtext mathvariant="normal">pseudo-</mtext><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">ML.\textrm{pseudo-}R^2</annotation></semantics></math></td>
<td>3.96</td>
<td>1.59</td>
<td>4</td>
<td>2.97</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>M</mi><mi>L</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.ML.\chi^2</annotation></semantics></math></td>
<td>2.84</td>
<td>2.05</td>
<td>2</td>
<td>1.48</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi><mi>.</mi><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">ML.R^2</annotation></semantics></math></td>
<td>5.15</td>
<td>1.31</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>B</mi><mi>C</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msubsup><mi>χ</mi><mtext mathvariant="normal">cum</mtext><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">K5.BC.Q^2\chi^2_{\textrm{cum}}</annotation></semantics></math></td>
<td>4.64</td>
<td>1.98</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi><mi>.</mi><mi>A</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC.AIC</annotation></semantics></math></td>
<td>3.42</td>
<td>0.87</td>
<td>3</td>
<td>1.48</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>B</mi><mi>C</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.BC.Q^2\chi^2</annotation></semantics></math></td>
<td>0.06</td>
<td>0.24</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi><mi>.</mi><mi>B</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC.BIC</annotation></semantics></math></td>
<td>3.02</td>
<td>0.79</td>
<td>3</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>B</mi><mi>C</mi><mi>.</mi><mtext mathvariant="normal">pre</mtext><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.BC.\textrm{pre}\chi^2</annotation></semantics></math></td>
<td>1.48</td>
<td>0.5</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">BC.\chi^2</annotation></semantics></math></td>
<td>5.3</td>
<td>1.57</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>B</mi><mi>C</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.BC.\chi^2</annotation></semantics></math></td>
<td>2.89</td>
<td>2.04</td>
<td>2</td>
<td>1.48</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi><mi>.</mi><mi>R</mi><mi>S</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">BC.RSS</annotation></semantics></math></td>
<td>5.14</td>
<td>1.33</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>B</mi><mi>C</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msubsup><mi>χ</mi><mtext mathvariant="normal">cum</mtext><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">K10.BC.Q^2\chi^2_{\textrm{cum}}</annotation></semantics></math></td>
<td>4.84</td>
<td>1.87</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi><mi>.</mi><mtext mathvariant="normal">pseudo-</mtext><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">BC.\textrm{pseudo-}R^2</annotation></semantics></math></td>
<td>3.98</td>
<td>1.58</td>
<td>4</td>
<td>2.97</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>B</mi><mi>C</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.BC.Q^2\chi^2</annotation></semantics></math></td>
<td>0.07</td>
<td>0.26</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi><mi>.</mi><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">BC.R^2</annotation></semantics></math></td>
<td>5.14</td>
<td>1.33</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>B</mi><mi>C</mi><mi>.</mi><mtext mathvariant="normal">pre</mtext><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.BC.\textrm{pre}\chi^2</annotation></semantics></math></td>
<td>1.54</td>
<td>0.5</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>R</mi><mi>.</mi><mi>A</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BR.AIC</annotation></semantics></math></td>
<td>3.43</td>
<td>0.81</td>
<td>3</td>
<td>1.48</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>B</mi><mi>C</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.BC.\chi^2</annotation></semantics></math></td>
<td>2.87</td>
<td>2.04</td>
<td>2</td>
<td>1.48</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>R</mi><mi>.</mi><mi>B</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BR.BIC</annotation></semantics></math></td>
<td>3.04</td>
<td>0.74</td>
<td>3</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>B</mi><mi>R</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msubsup><mi>χ</mi><mtext mathvariant="normal">cum</mtext><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">K5.BR.Q^2\chi^2_{\textrm{cum}}</annotation></semantics></math></td>
<td>4.42</td>
<td>2.02</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>R</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">BR.\chi^2</annotation></semantics></math></td>
<td>5.16</td>
<td>1.64</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>B</mi><mi>R</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.BR.Q^2\chi^2</annotation></semantics></math></td>
<td>0.07</td>
<td>0.26</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>R</mi><mi>.</mi><mi>R</mi><mi>S</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">BR.RSS</annotation></semantics></math></td>
<td>5.03</td>
<td>1.28</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>B</mi><mi>R</mi><mi>.</mi><mtext mathvariant="normal">pre</mtext><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.BR.\textrm{pre}\chi^2</annotation></semantics></math></td>
<td>1.47</td>
<td>0.5</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>R</mi><mi>.</mi><mtext mathvariant="normal">pseudo-</mtext><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">BR.\textrm{pseudo-}R^2</annotation></semantics></math></td>
<td>3.95</td>
<td>1.53</td>
<td>4</td>
<td>1.48</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>B</mi><mi>R</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.BR.\chi^2</annotation></semantics></math></td>
<td>2.89</td>
<td>2.06</td>
<td>2</td>
<td>1.48</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>R</mi><mi>.</mi><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">BR.R^2</annotation></semantics></math></td>
<td>5.03</td>
<td>1.28</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>B</mi><mi>R</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msubsup><mi>χ</mi><mtext mathvariant="normal">cum</mtext><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">K10.BR.Q^2\chi^2_{\textrm{cum}}</annotation></semantics></math></td>
<td>4.53</td>
<td>1.94</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>M</mi><mi>L</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msubsup><mi>χ</mi><mtext mathvariant="normal">cum</mtext><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">K5.ML.Q^2\chi^2_{\textrm{cum}}</annotation></semantics></math></td>
<td>4.69</td>
<td>1.89</td>
<td>6</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>B</mi><mi>R</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.BR.Q^2\chi^2</annotation></semantics></math></td>
<td>0.08</td>
<td>0.27</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>M</mi><mi>L</mi><mi>.</mi><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.ML.Q^2\chi^2</annotation></semantics></math></td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>B</mi><mi>R</mi><mi>.</mi><mtext mathvariant="normal">pre</mtext><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.BR.\textrm{pre}\chi^2</annotation></semantics></math></td>
<td>1.52</td>
<td>0.5</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>5</mn><mi>.</mi><mi>M</mi><mi>L</mi><mi>.</mi><mtext mathvariant="normal">pre</mtext><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K5.ML.\textrm{pre}\chi^2</annotation></semantics></math></td>
<td>1.43</td>
<td>0.5</td>
<td>1</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mn>10</mn><mi>.</mi><mi>B</mi><mi>R</mi><mi>.</mi><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">K10.BR.\chi^2</annotation></semantics></math></td>
<td>2.87</td>
<td>2.04</td>
<td>2</td>
<td>1.48</td>
</tr>
</tbody>
</table>
<p>Note that the MAD is the median of the absolute deviations from the
median. It is a robust indicator of dispersion naturally associated with
the median. A value of 0 for the MAD means that in more than half of the
simulations, the value chosen for the number of components is equal to
the median value of all simulations.</p>
<p>In general, the results of the simulation study show that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Q^2\chi^2</annotation></semantics></math>
(5-CV and 10-CV), already known for its surprising behavior in PLS
logistic regression (Bastien, 2005)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;Ph. BASTIEN, V. ESPOSITO VINZI et M.
TENENHAUS&lt;/em&gt;. Pls generalised linear regression. Computational
Statistics &amp;amp; Data Analysis, 48(1):17–46, 2005.&lt;/p&gt;"><sup>37</sup></a>, (Meyer, 2010)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;N. MEYER, M. MAUMY-BERTRAND et F. BERTRAND&lt;/em&gt;.
Comparaison de variantes de régressions logistiques PLS et de régression
PLS sur variables qualitatives : application aux donnés d’allélotypage.
Journal de la Société Française De Statistique, 151(2):1–18, 2010.&lt;/p&gt;"><sup>38</sup></a>, does not behave
much better for the Beta PLS regression models. Maximizing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
or
pseudo-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
criteria, also proves inefficient. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">AIC</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BIC</annotation></semantics></math>
criteria systematically retain a few too many components. This tendency
is also known in the case of the traditional PLS Regression (Kramer,
2011)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;N. KRAEMER et M. SUGIYAMA&lt;/em&gt;. The Degrees of
Freedom of Partial Least Squares Regression. Journal of the American
Statistical Association, 106(494):697–705, 2011.&lt;/p&gt;"><sup>39</sup></a>
as well as in the case of the Logistic PLS Regression (Meyer, 2010)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;N. MEYER, M. MAUMY-BERTRAND et F. BERTRAND&lt;/em&gt;.
Comparaison de variantes de régressions logistiques PLS et de régression
PLS sur variables qualitatives : application aux donnés d’allélotypage.
Journal de la Société Française De Statistique, 151(2):1–18, 2010.&lt;/p&gt;"><sup>40</sup></a>.</p>
<table class="table">
<caption>Table 2. Maximum number of calculated components and failed
fits.</caption>
<thead><tr class="header">
<th></th>
<th>Mean</th>
<th>SD</th>
<th>Median</th>
<th>MAD</th>
<th>Failures</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>ML</td>
<td>5.55</td>
<td>1.22</td>
<td>6</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>BC</td>
<td>5.52</td>
<td>1.24</td>
<td>6</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>BR</td>
<td>5.43</td>
<td>1.22</td>
<td>6</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>ML (5-CV)</td>
<td>5.59</td>
<td>1.17</td>
<td>6</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>ML (10-CV)</td>
<td>5.55</td>
<td>1.22</td>
<td>6</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>BC (5-CV)</td>
<td>5.63</td>
<td>1.08</td>
<td>6</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="odd">
<td>BC (10-CV)</td>
<td>5.6</td>
<td>1.13</td>
<td>6</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>BR (5-CV)</td>
<td>5.62</td>
<td>1.09</td>
<td>6</td>
<td>0</td>
<td>4</td>
</tr>
<tr class="odd">
<td>BR (10-CV)</td>
<td>5.6</td>
<td>1.13</td>
<td>6</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>We find that the proposed PLS Beta Regression algorithm succeeds in
extracting the maximum number of components requested very consistently
and that the fit is impossible in only one of the 100 simulations for
the BR technique. The cross-validation, on the other hand, is completed
in 98.5 % of the simulations.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-of-application-in-medicine">Example of application in medicine<a class="anchor" aria-label="anchor" href="#example-of-application-in-medicine"></a>
</h2>
<p>Cancerous tumors represent one of the three main causes of death in
the Western world. The understanding of the mechanisms of cancer
pathologies is currently based on the study of the interrelationships of
acquired genetic abnormalities, which appear in tissues during the
process of cancerization. These abnormalities are frequently analyzed by
allelotyping, allowing to determine for a more or less important number
of gene sites, the presence or not of a modification of the number of
copies of each gene. The multivariate description of these anomalies is
informative about the carcinogenesis process. Furthermore, the set of
these gene sites with or without abnormalities can be used to try to
predict certain clinical or biological characteristics of the tumor such
as the tumor cell count on biopsy of a lesion. Modeling in a statistical
model of rate, variable whose space of variation is contained in the
closed interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>;</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0;1]</annotation></semantics></math>
as predicted variable suggests the use of Beta regression. Furthermore,
allelotyping data are characterized by frequent collinearity and a large
proportion of missing data. Moreover, the data matrix often has
dimensions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>;</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i;j)</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>&gt;</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j&gt;i</annotation></semantics></math>,
which makes the matrix non-invertible, posing difficulties in fitting a
regression model. The PLS Beta regression that we have developed is
therefore particularly well suited to deal with allelotyping data in the
particular context of predicting a rate variable.</p>
<p>The example is that of allelotyping data obtained on a series of 93
patients with different types of lung cancer and with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>23.2</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">23.2 \%</annotation></semantics></math>
missing values. The predicted variable is the tumor cellularity rate of
the intraoperative tumor specimen. The explanatory variables are
composed of 56 binary variables indicating the presence of an
abnormality on each of the 56 microsatellites and three clinical
variables.</p>
<p>The selection of variables is very important in this example because
it allows to define a subset of predictors, i.e. gene sites, able to
predict the tumor cell rate. Indeed, cancer pathologies are acquired
genetic pathologies and some of these anomalies are the cause and others
the consequence of the tumor pathology. Moreover, the information
contained in the different microsatellite gene sites is potentially
redundant. Variable selection, separating variables that probably play a
driving role in tumor development from variables that merely reflect
random background noise induced by abnormalities caused by tumor
development, is therefore an indispensable aid to understanding the
underlying mechanisms of tumorigenesis.</p>
<p>Table 3 summarizes the values of different criteria used to determine
the number of components to be used to properly model the allelotype
data with BR and a logit link.</p>
<table class="table">
<caption>Table 3. Selecting the number of components, BR method and
logit link.</caption>
<colgroup>
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th>Nb of Comp.</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>AIC</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>23.9</mn></mrow><annotation encoding="application/x-tex">-23.9</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>48.2</mn></mrow><annotation encoding="application/x-tex">-48.2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>63.4</mn></mrow><annotation encoding="application/x-tex">-63.4</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>76.2</mn></mrow><annotation encoding="application/x-tex">-76.2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>90.2</mn></mrow><annotation encoding="application/x-tex">-90.2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>101.5</mn></mrow><annotation encoding="application/x-tex">-101.5</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>114.2</mn></mrow><annotation encoding="application/x-tex">-114.2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>116.9</mn></mrow><annotation encoding="application/x-tex">-116.9</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>120.5</mn></mrow><annotation encoding="application/x-tex">-120.5</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">−</mi><mn mathvariant="bold">121.6</mn></mrow><annotation encoding="application/x-tex">\mathbf{-121.6}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>BIC</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>18.5</mn></mrow><annotation encoding="application/x-tex">-18.5</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>40.2</mn></mrow><annotation encoding="application/x-tex">-40.2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>52.7</mn></mrow><annotation encoding="application/x-tex">-52.7</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>62.9</mn></mrow><annotation encoding="application/x-tex">-62.9</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>74.2</mn></mrow><annotation encoding="application/x-tex">-74.2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>82.8</mn></mrow><annotation encoding="application/x-tex">-82.8</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>92.9</mn></mrow><annotation encoding="application/x-tex">-92.9</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>92.9</mn></mrow><annotation encoding="application/x-tex">-92.9</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">−</mi><mn mathvariant="bold">93.8</mn></mrow><annotation encoding="application/x-tex">\mathbf{-93.8}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>92.3</mn></mrow><annotation encoding="application/x-tex">-92.3</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Pred Sig</td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>15</mn><annotation encoding="application/x-tex">15</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>7</mn><annotation encoding="application/x-tex">7</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>𝟐</mn><annotation encoding="application/x-tex">\mathbf{2}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Q^2\chi^2</annotation></semantics></math>
(5-CV)</td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">−</mi><mn mathvariant="bold">0.3</mn></mrow><annotation encoding="application/x-tex">\mathbf{-0.3}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>1.0</mn></mrow><annotation encoding="application/x-tex">-1.0</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>1.8</mn></mrow><annotation encoding="application/x-tex">-1.8</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>2.8</mn></mrow><annotation encoding="application/x-tex">-2.8</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>3.8</mn></mrow><annotation encoding="application/x-tex">-3.8</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>5.9</mn></mrow><annotation encoding="application/x-tex">-5.9</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>8.9</mn></mrow><annotation encoding="application/x-tex">-8.9</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>10.4</mn></mrow><annotation encoding="application/x-tex">-10.4</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>8.0</mn></mrow><annotation encoding="application/x-tex">-8.0</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
Pearson</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>98.3</mn><annotation encoding="application/x-tex">98.3</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>97.2</mn><annotation encoding="application/x-tex">97.2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>96.0</mn><annotation encoding="application/x-tex">96.0</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn mathvariant="bold">100.0</mn><annotation encoding="application/x-tex">\mathbf{100.0}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>96.8</mn><annotation encoding="application/x-tex">96.8</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>91.5</mn><annotation encoding="application/x-tex">91.5</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>89.1</mn><annotation encoding="application/x-tex">89.1</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>88.6</mn><annotation encoding="application/x-tex">88.6</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>87.4</mn><annotation encoding="application/x-tex">87.4</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>86.4</mn><annotation encoding="application/x-tex">86.4</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>pseudo-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
</td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.21</mn><annotation encoding="application/x-tex">0.21</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.31</mn><annotation encoding="application/x-tex">0.31</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.40</mn><annotation encoding="application/x-tex">0.40</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.47</mn><annotation encoding="application/x-tex">0.47</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.53</mn><annotation encoding="application/x-tex">0.53</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.58</mn><annotation encoding="application/x-tex">0.58</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.59</mn><annotation encoding="application/x-tex">0.59</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.61</mn><annotation encoding="application/x-tex">0.61</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn mathvariant="bold">0.62</mn><annotation encoding="application/x-tex">\mathbf{0.62}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
Pearson</td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.22</mn><annotation encoding="application/x-tex">0.22</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.35</mn><annotation encoding="application/x-tex">0.35</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.41</mn><annotation encoding="application/x-tex">0.41</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.50</mn><annotation encoding="application/x-tex">0.50</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.57</mn><annotation encoding="application/x-tex">0.57</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.64</mn><annotation encoding="application/x-tex">0.64</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.65</mn><annotation encoding="application/x-tex">0.65</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.67</mn><annotation encoding="application/x-tex">0.67</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn mathvariant="bold">0.68</mn><annotation encoding="application/x-tex">\mathbf{0.68}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>The stopping criterion as soon as there is no significant predictor
would lead us to choose 6 components. This choice is confirmed by the
pseudo-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
criteria for which a kink appears from 6 components.</p>
<p>The BIC criterion invites us to choose 8 components and the AIC
criterion an even higher number. During the simulation study, we noticed
that these criteria are liberal and generally retain a few too many
components.</p>
<p>Depending on the criteria, 6 or 8 components should be retained for a
logit link. Taking into account the previous simulation study, we decide
to retain 6 components. The same study was performed with the BC method
or a log-log link and leads to the same conclusions.</p>
<p>Confidence intervals are then obtained for each of the predictors
using bootstrap samples of size 1000 and the normal, basic, percentile
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
techniques.</p>
<p>The use of bootstrap techniques to establish the significance of the
predictors of a PLS Beta regression model is illustrated in Figure 2 for
the case of the 6-component model with the BR bias reduction
technique.</p>
<p>In the end, we use the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
technique, known for its good properties, to select the variables that
are significant at the 5 % threshold by retaining those for which the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
confidence interval does not contain 0, as shown in Figure 3 for the
case of the 6-component model with the BR bias reduction technique.</p>
<p>Thus, we retain the variables in Table 4 as having a significant
effect on the tumor cellularity rate of the intraoperative tumor
specimen. We find that the two techniques for dealing with the Beta
regression bias have results that differ only in the single variable
EGF3, significant at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">5 \%</annotation></semantics></math>
threshold for the BC technique and not for the BR technique.</p>
<table style="width:100%;" class="table">
<caption>Table 4. Significant Variables.</caption>
<colgroup>
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th>Nb Comp</th>
<th>Significant Variables</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>6 components</td>
<td>P4</td>
<td>C3M</td>
<td>RB</td>
<td>FL7A</td>
<td>W2</td>
<td>W4</td>
</tr>
<tr class="even">
<td></td>
<td>MT4</td>
<td>HLA</td>
<td>HLD</td>
<td>HLB</td>
<td>EA3</td>
<td>EA2</td>
</tr>
<tr class="odd">
<td>Bias Correction</td>
<td>EGF2</td>
<td>EGF3</td>
<td>FL7B</td>
<td>VSFGFR3</td>
<td>VSTOP1</td>
<td>VSTOP2A</td>
</tr>
<tr class="even">
<td></td>
<td>VSEGFR</td>
<td>AFRAEGFR</td>
<td>SRXRA</td>
<td>SMT</td>
<td>SHL</td>
<td>SEB</td>
</tr>
<tr class="odd">
<td>6 components</td>
<td>P4</td>
<td>C3M</td>
<td>RB</td>
<td>FL7A</td>
<td>W2</td>
<td>W4</td>
</tr>
<tr class="even">
<td></td>
<td>MT4</td>
<td>HLA</td>
<td>HLD</td>
<td>HLB</td>
<td>EA3</td>
<td>EA2</td>
</tr>
<tr class="odd">
<td>Bias Reduction</td>
<td>EGF2</td>
<td>FL7B</td>
<td>VSFGFR3</td>
<td>VSTOP1</td>
<td>VSTOP2A</td>
<td>VSEGFR</td>
</tr>
<tr class="even">
<td></td>
<td>AFRAEGFR</td>
<td>SRXRA</td>
<td>SMT</td>
<td>SHL</td>
<td>SEB</td>
<td></td>
</tr>
</tbody>
</table>
<p>Figure 4 allows us to evaluate the stability of the significant
variables selected by the bootstrap technique
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
for a number of components varying from 1 to 6 and the two techniques BC
and BR for fitting the Beta regression model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/plsRglm/" class="external-link">plsRglm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/plsRbeta/">plsRbeta</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">TxTum</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TxTum.mod.bootBR6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootplsbeta.html">bootplsbeta</a></span><span class="op">(</span><span class="fu"><a href="../reference/plsRbeta.html">plsRbeta</a></span><span class="op">(</span>formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">CELTUMCO</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">~</span><span class="va">.</span>,data<span class="op">=</span><span class="va">TxTum</span>,nt<span class="op">=</span><span class="fl">6</span>,modele<span class="op">=</span><span class="st">"pls-beta"</span>,type<span class="op">=</span><span class="st">"BR"</span><span class="op">)</span>, sim<span class="op">=</span><span class="st">"ordinary"</span>, stype<span class="op">=</span><span class="st">"i"</span>, R<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#save(TxTum.mod.bootBR6,file="TxTum.mod.bootBR6.Rdata")</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TxTum.mod.bootBR6"</span><span class="op">)</span></span>
<span><span class="va">temp.ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu">plsRglm</span><span class="fu">::</span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/confints.bootpls.html" class="external-link">confints.bootpls</a></span><span class="op">(</span><span class="va">TxTum.mod.bootBR6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/boxplots.bootpls.html" class="external-link">boxplots.bootpls</a></span><span class="op">(</span><span class="va">TxTum.mod.bootBR6</span>,indices <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-4-1.png" alt="Figure 1. Boxplot of bootstrap distributions, 6 components BR." width="480"><p class="caption">
Figure 1. Boxplot of bootstrap distributions, 6 components BR.
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plsRglm</span><span class="fu">::</span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/plots.confints.bootpls.html" class="external-link">plots.confints.bootpls</a></span><span class="op">(</span><span class="va">temp.ci</span>,prednames<span class="op">=</span><span class="cn">TRUE</span>,indices <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-5-1.png" alt="Figure 2. Bootstrap 95% confidence intervals, 6 components BR." width="480"><p class="caption">
Figure 2. Bootstrap 95% confidence intervals, 6 components BR.
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ind_BCa_nt6BR</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">temp.ci</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">&amp;</span><span class="va">temp.ci</span><span class="op">[</span>,<span class="fl">8</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">|</span><span class="op">(</span><span class="va">temp.ci</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">&amp;</span><span class="va">temp.ci</span><span class="op">[</span>,<span class="fl">8</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">[</span><span class="va">ind_BCa_nt6BR</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "P4"       "C3M"      "RB"       "FL7A"     "W2"       "W4"      </span></span>
<span><span class="co">#&gt;  [7] "MT4"      "HLA"      "HLD"      "HLB"      "EA3"      "EA2"     </span></span>
<span><span class="co">#&gt; [13] "EGF2"     "FL7B"     "VSFGFR3"  "VSTOP1"   "VSTOP2A"  "VSEGFR"  </span></span>
<span><span class="co">#&gt; [19] "AFRAEGFR" "SRXRA"    "SMT"      "SHL"      "SEB"</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plsRglm</span><span class="fu">::</span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/plots.confints.bootpls.html" class="external-link">plots.confints.bootpls</a></span><span class="op">(</span><span class="va">temp.ci</span>,prednames<span class="op">=</span><span class="cn">TRUE</span>,indices <span class="op">=</span> <span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">ind_BCa_nt6BR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,articlestyle<span class="op">=</span><span class="cn">FALSE</span>,legendpos<span class="op">=</span><span class="st">"topright"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-7-1.png" alt="Figure 3. Bootstrap 95% confidence intervals, BCa significant variables, 6 components BR." width="480"><p class="caption">
Figure 3. Bootstrap 95% confidence intervals, BCa significant variables,
6 components BR.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#TxTum &lt;- read.table("MET_rev_edt.txt",sep="\t",header=TRUE)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TxTum.mod.bootBC1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp.ci</span> <span class="op">&lt;-</span> <span class="fu">plsRglm</span><span class="fu">::</span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/confints.bootpls.html" class="external-link">confints.bootpls</a></span><span class="op">(</span><span class="va">TxTum.mod.bootBC1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt1BC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt2BC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt3BC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt4BC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt5BC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt6BC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt1BR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt2BR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt3BR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt4BR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt5BR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt6BR"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">[</span><span class="va">ind_BCa_nt1BC</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "P4"     "E1"     "RB"     "P53"    "HLA"    "EA2"    "F3B"    "VSEGFR"</span></span>
<span><span class="co">#&gt;  [9] "SHL"    "SEB"</span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">TxTum.mod.bootBC1</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "age"      "sexe"     "HISTOADK" "H2"       "P3"       "P4"      </span></span>
<span><span class="co">#&gt;  [7] "E1"       "P5"       "R10"      "C3M"      "P6"       "RB"      </span></span>
<span><span class="co">#&gt; [13] "FL7A"     "P53"      "W2"       "P2"       "P1"       "W4"      </span></span>
<span><span class="co">#&gt; [19] "MT1"      "MT2"      "MT4"      "MT3"      "HLA"      "HLD"     </span></span>
<span><span class="co">#&gt; [25] "HLC"      "HLB"      "EA1"      "EA3"      "EA2"      "EA4"     </span></span>
<span><span class="co">#&gt; [31] "EB1"      "EB2"      "EB3"      "EB4"      "EGF1"     "EGF2"    </span></span>
<span><span class="co">#&gt; [37] "EGF3"     "EGF4"     "EGF5"     "EGF6"     "FL7B"     "VSFGF7"  </span></span>
<span><span class="co">#&gt; [43] "F3A"      "F3B"      "VSFGFR3"  "F4"       "Q5"       "VSTOP1"  </span></span>
<span><span class="co">#&gt; [49] "VSTOP2A"  "VSEGFR"   "AFRAEGFR" "SRXRA"    "SMT"      "QMTAMPN" </span></span>
<span><span class="co">#&gt; [55] "QMTDELN"  "SHL"      "SEA"      "SEB"      "QPCRFGF7"</span></span>
<span></span>
<span><span class="va">indics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ind_BCa_nt1BC</span>,</span>
<span><span class="va">ind_BCa_nt2BC</span>,</span>
<span><span class="va">ind_BCa_nt3BC</span>,</span>
<span><span class="va">ind_BCa_nt4BC</span>,</span>
<span><span class="va">ind_BCa_nt5BC</span>,</span>
<span><span class="va">ind_BCa_nt6BC</span>,</span>
<span><span class="va">ind_BCa_nt1BR</span>,</span>
<span><span class="va">ind_BCa_nt2BR</span>,</span>
<span><span class="va">ind_BCa_nt3BR</span>,</span>
<span><span class="va">ind_BCa_nt4BR</span>,</span>
<span><span class="va">ind_BCa_nt5BR</span>,</span>
<span><span class="va">ind_BCa_nt6BR</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nbpreds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">indics</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">indics</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">nbpreds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>,<span class="st">"6"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">nbpreds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>,<span class="st">"BR"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nbpreds</span></span>
<span><span class="co">#&gt;     1 2  3  4  5  6</span></span>
<span><span class="co">#&gt; BC 10 7 11 15 23 24</span></span>
<span><span class="co">#&gt; BR  9 7  9 15 21 23</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inone</span> <span class="op">&lt;-</span> <span class="va">indics</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">indics</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span>,<span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">4</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">11</span>,<span class="fl">6</span>,<span class="fl">12</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">inone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">inone</span>,<span class="fl">1</span>,<span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">inone</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "age"      "P4"       "E1"       "C3M"      "RB"       "FL7A"    </span></span>
<span><span class="co">#&gt;  [7] "P53"      "W2"       "P2"       "W4"       "MT4"      "HLA"     </span></span>
<span><span class="co">#&gt; [13] "HLD"      "HLB"      "EA3"      "EA2"      "EB4"      "EGF2"    </span></span>
<span><span class="co">#&gt; [19] "EGF3"     "EGF4"     "FL7B"     "F3B"      "VSFGFR3"  "VSTOP1"  </span></span>
<span><span class="co">#&gt; [25] "VSTOP2A"  "VSEGFR"   "AFRAEGFR" "SRXRA"    "SMT"      "SHL"     </span></span>
<span><span class="co">#&gt; [31] "SEA"      "SEB"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">inone</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC1"</span>,<span class="st">"BR1"</span>,<span class="st">"BC2"</span>,<span class="st">"BR2"</span>,<span class="st">"BC3"</span>,<span class="st">"BR3"</span>,<span class="st">"BC4"</span>,<span class="st">"BR4"</span>,<span class="st">"BC5"</span>,<span class="st">"BR5"</span>,<span class="st">"BC6"</span>,<span class="st">"BR6"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">inone</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1 BC"</span>,<span class="st">"  BR"</span>,<span class="st">"2 BC"</span>,<span class="st">"  BR"</span>,<span class="st">"3 BC"</span>,<span class="st">"  BR"</span>,<span class="st">"4 BC"</span>,<span class="st">"  BR"</span>,<span class="st">"5 BC"</span>,<span class="st">"  BR"</span>,<span class="st">"6 BC"</span>,<span class="st">"  BR"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inone</span></span>
<span><span class="co">#&gt;          1 BC   BR 2 BC   BR 3 BC   BR 4 BC   BR 5 BC   BR 6 BC   BR</span></span>
<span><span class="co">#&gt; age         0    0    0    0    0    0    1    1    0    0    0    0</span></span>
<span><span class="co">#&gt; P4          1    1    1    1    1    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; E1          1    1    1    1    1    1    1    1    0    0    0    0</span></span>
<span><span class="co">#&gt; C3M         0    0    0    0    0    0    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; RB          1    1    1    1    1    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; FL7A        0    0    1    1    1    0    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; P53         1    1    1    1    1    1    1    1    1    1    0    0</span></span>
<span><span class="co">#&gt; W2          0    0    0    0    0    0    0    0    1    1    1    1</span></span>
<span><span class="co">#&gt; P2          0    0    0    0    1    1    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; W4          0    0    0    0    0    0    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; MT4         0    0    0    0    0    0    0    0    1    0    1    1</span></span>
<span><span class="co">#&gt; HLA         1    0    0    0    1    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; HLD         0    0    0    0    1    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; HLB         0    0    0    0    0    0    0    0    1    1    1    1</span></span>
<span><span class="co">#&gt; EA3         0    0    0    0    0    0    0    0    1    1    1    1</span></span>
<span><span class="co">#&gt; EA2         1    1    1    1    1    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; EB4         0    1    0    0    0    0    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; EGF2        0    0    0    0    0    0    0    0    1    0    1    1</span></span>
<span><span class="co">#&gt; EGF3        0    0    0    0    0    0    0    0    0    0    1    0</span></span>
<span><span class="co">#&gt; EGF4        0    0    0    0    0    0    1    1    0    0    0    0</span></span>
<span><span class="co">#&gt; FL7B        0    0    0    0    0    0    0    0    1    1    1    1</span></span>
<span><span class="co">#&gt; F3B         1    1    0    0    0    0    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; VSFGFR3     0    0    0    0    0    0    0    0    1    1    1    1</span></span>
<span><span class="co">#&gt; VSTOP1      0    0    0    0    0    0    0    0    1    1    1    1</span></span>
<span><span class="co">#&gt; VSTOP2A     0    0    0    0    1    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; VSEGFR      1    1    0    0    0    0    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; AFRAEGFR    0    0    0    0    0    0    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; SRXRA       0    0    0    0    0    0    0    0    1    1    1    1</span></span>
<span><span class="co">#&gt; SMT         0    0    0    0    0    0    0    0    1    1    1    1</span></span>
<span><span class="co">#&gt; SHL         1    0    0    0    1    0    0    0    0    0    1    1</span></span>
<span><span class="co">#&gt; SEA         0    0    1    1    0    0    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; SEB         1    1    0    0    0    0    0    0    1    1    1    1</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/biometry/bipartite" class="external-link">bipartite</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: sna</span></span>
<span><span class="co">#&gt; Loading required package: statnet.common</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'statnet.common'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     attr, order, replace</span></span>
<span><span class="co">#&gt; Loading required package: network</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 'network' 1.19.0 (2024-12-08), part of the Statnet Project</span></span>
<span><span class="co">#&gt; * 'news(package="network")' for changes since last version</span></span>
<span><span class="co">#&gt; * 'citation("network")' for citation information</span></span>
<span><span class="co">#&gt; * 'https://statnet.org' for help, support, and other information</span></span>
<span><span class="co">#&gt; sna: Tools for Social Network Analysis</span></span>
<span><span class="co">#&gt; Version 2.8 created on 2024-09-07.</span></span>
<span><span class="co">#&gt; copyright (c) 2005, Carter T. Butts, University of California-Irvine</span></span>
<span><span class="co">#&gt;  For citation information, type citation("sna").</span></span>
<span><span class="co">#&gt;  Type help(package="sna") to get started.</span></span>
<span><span class="co">#&gt; Loading required package: vegan</span></span>
<span><span class="co">#&gt; Loading required package: permute</span></span>
<span><span class="co">#&gt;  This is bipartite 2.22.</span></span>
<span><span class="co">#&gt;  For latest changes see versionlog in ?"bipartite-package". For citation see: citation("bipartite").</span></span>
<span><span class="co">#&gt;  Have a nice time plotting and analysing two-mode networks.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'bipartite'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:vegan':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     nullmodel</span></span>
<span><span class="fu">bipartite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bipartite/man/visweb.html" class="external-link">visweb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">inone</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"None"</span>,labsize<span class="op">=</span><span class="fl">2</span>,square<span class="op">=</span><span class="st">"b"</span>,box.col<span class="op">=</span><span class="st">"grey25"</span>,pred.lablength<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-12-1.png" alt="Figure 4. Selected variables using the bootstrap BCa technique." width="480"><p class="caption">
Figure 4. Selected variables using the bootstrap BCa technique.
</p>
</div>
</div>
<div class="section level2">
<h2 id="example-of-application-in-chemometrics">Example of application in chemometrics<a class="anchor" aria-label="anchor" href="#example-of-application-in-chemometrics"></a>
</h2>
<p>The goal is to find compounds that can predict the rate of cancer
cell infiltration in patients from spectrometry data. A healthy patient
has 0 % of cancer cells in a biopsy while a sick patient will have in a
biopsy a % higher than the sample contains cancer cells. The interest of
this experiment is to try to reduce considerably the time of analysis of
the biopsies by avoiding the need for a counting by a doctor specialized
in anatomy and pathological cytology. An additional statistical
difficulty appears here: there are more variables (180) than individuals
(80). More details on the experimental protocol followed are available
in the article in which this dataset has already been published (Piotto,
2012)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;M. PIOTTO, F.-M. MOUSSALLIEH, A. NEUVILLE, J.-P.
BELLOCQ, K. ELBAYED et I.J. NAMER&lt;/em&gt;. Towards real-time metabolic
profiling of a biopsy specimen during a surgical operation by 1h high
resolution magic angle spinning nuclear magnetic resonance : a case
report. Journal of Medical Case Reports, 6(1), 2012.&lt;/p&gt;"><sup>41</sup></a>.</p>
<p>We begin by determining the number of components to use to fit a
model with all areas of the spectrum as explanatory variables. Table 5
contains the components for selecting the number of components. We again
see the tendency of the AIC and BIC criteria to retain a very high
number of components, namely more than 10. On the other hand, in this
example the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Q^2\chi^2</annotation></semantics></math>
criterion, estimated using a 10-group cross-validation (10-CV), seems
relevant and invites us to keep 3 components. The same is true for the
Pearson
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>h</mi><msup><mi>i</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">chi^2</annotation></semantics></math>.
The
pseudo-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
is also in line with this since we observe a rapid decrease in the
explanatory contribution following the addition of additional components
beyond the third one.</p>
<table class="table">
<caption>Table 5. Selecting the number of components.</caption>
<colgroup>
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th>Nb of Comp.</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>10</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>AIC</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>32.35</mn></mrow><annotation encoding="application/x-tex">-32.35</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>110.26</mn></mrow><annotation encoding="application/x-tex">-110.26</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>128.86</mn></mrow><annotation encoding="application/x-tex">-128.86</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>141.93</mn></mrow><annotation encoding="application/x-tex">-141.93</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>152.50</mn></mrow><annotation encoding="application/x-tex">-152.50</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>165.93</mn></mrow><annotation encoding="application/x-tex">-165.93</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>183.71</mn></mrow><annotation encoding="application/x-tex">-183.71</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>193.49</mn></mrow><annotation encoding="application/x-tex">-193.49</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>206.75</mn></mrow><annotation encoding="application/x-tex">-206.75</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>217.21</mn></mrow><annotation encoding="application/x-tex">-217.21</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">−</mi><mn mathvariant="bold">231.30</mn></mrow><annotation encoding="application/x-tex">\mathbf{-231.30}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>BIC</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>27.58</mn></mrow><annotation encoding="application/x-tex">-27.58</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>103.11</mn></mrow><annotation encoding="application/x-tex">-103.11</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>119.33</mn></mrow><annotation encoding="application/x-tex">-119.33</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>130.02</mn></mrow><annotation encoding="application/x-tex">-130.02</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>138.21</mn></mrow><annotation encoding="application/x-tex">-138.21</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>149.25</mn></mrow><annotation encoding="application/x-tex">-149.25</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>164.66</mn></mrow><annotation encoding="application/x-tex">-164.66</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>172.05</mn></mrow><annotation encoding="application/x-tex">-172.05</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>182.93</mn></mrow><annotation encoding="application/x-tex">-182.93</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>191.01</mn></mrow><annotation encoding="application/x-tex">-191.01</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">−</mi><mn mathvariant="bold">202.71</mn></mrow><annotation encoding="application/x-tex">\mathbf{-202.71}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mn>2</mn></msup><msup><mi>χ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Q^2\chi^2</annotation></semantics></math>
(10-CV)</td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>1.05</mn></mrow><annotation encoding="application/x-tex">-1.05</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>2.68</mn></mrow><annotation encoding="application/x-tex">-2.68</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">−</mi><mn mathvariant="bold">1.00</mn></mrow><annotation encoding="application/x-tex">\mathbf{-1.00}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>1.51</mn></mrow><annotation encoding="application/x-tex">-1.51</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>2.34</mn></mrow><annotation encoding="application/x-tex">-2.34</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>3.71</mn></mrow><annotation encoding="application/x-tex">-3.71</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>8.04</mn></mrow><annotation encoding="application/x-tex">-8.04</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>211.19</mn></mrow><annotation encoding="application/x-tex">-211.19</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>5.16</mn><mi>E</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">-5.16E3</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>4.16</mn><mi>E</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">-4.16E4</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
Pearson</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>76.78</mn><annotation encoding="application/x-tex">76.78</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>76.44</mn><annotation encoding="application/x-tex">76.44</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn mathvariant="bold">80.58</mn><annotation encoding="application/x-tex">\mathbf{80.58}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>76.20</mn><annotation encoding="application/x-tex">76.20</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>81.95</mn><annotation encoding="application/x-tex">81.95</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>81.08</mn><annotation encoding="application/x-tex">81.08</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>74.06</mn><annotation encoding="application/x-tex">74.06</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>76.39</mn><annotation encoding="application/x-tex">76.39</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>72.62</mn><annotation encoding="application/x-tex">72.62</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>73.21</mn><annotation encoding="application/x-tex">73.21</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>71.82</mn><annotation encoding="application/x-tex">71.82</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>pseudo-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
</td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.70</mn><annotation encoding="application/x-tex">0.70</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.78</mn><annotation encoding="application/x-tex">0.78</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.82</mn><annotation encoding="application/x-tex">0.82</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.85</mn><annotation encoding="application/x-tex">0.85</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.87</mn><annotation encoding="application/x-tex">0.87</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.89</mn><annotation encoding="application/x-tex">0.89</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.90</mn><annotation encoding="application/x-tex">0.90</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.92</mn><annotation encoding="application/x-tex">0.92</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.93</mn><annotation encoding="application/x-tex">0.93</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn mathvariant="bold">0.94</mn><annotation encoding="application/x-tex">\mathbf{0.94}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
Pearson</td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.57</mn><annotation encoding="application/x-tex">0.57</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.64</mn><annotation encoding="application/x-tex">0.64</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.73</mn><annotation encoding="application/x-tex">0.73</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.75</mn><annotation encoding="application/x-tex">0.75</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.81</mn><annotation encoding="application/x-tex">0.81</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.86</mn><annotation encoding="application/x-tex">0.86</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.88</mn><annotation encoding="application/x-tex">0.88</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.90</mn><annotation encoding="application/x-tex">0.90</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.92</mn><annotation encoding="application/x-tex">0.92</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn mathvariant="bold">0.94</mn><annotation encoding="application/x-tex">\mathbf{0.94}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>We then construct bootstrap samples of size 250 of the predictor
coefficients for a 3-component model with the bias reduction (BR)
method. Figure 5 gives the whisker boxes of these distributions.
Confidence intervals are then obtained for each of the predictors with
the normal, basic, percentile or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
techniques. In the end, we use the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
technique, known for its good properties (Diciccio, 1996)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;T.J. DICICCIO et B. EFRON&lt;/em&gt;. Bootstrap
confidence intervals (with discussion). Statistical Science, 11:189–228,
1996.&lt;/p&gt;"><sup>42</sup></a>, to select the
significant variables at the 5 % threshold by retaining those for which
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
confidence interval does not contain 0 as illustrated by Figure 6 for
the case of the 3-component model with the BR bias reduction
technique.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">colon</span><span class="op">)</span></span>
<span><span class="va">orig</span> <span class="op">&lt;-</span> <span class="va">colon</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modpls.boot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootplsbeta.html">bootplsbeta</a></span><span class="op">(</span><span class="fu"><a href="../reference/plsRbeta.html">plsRbeta</a></span><span class="op">(</span><span class="va">X..Cellules.tumorales</span><span class="op">~</span><span class="va">.</span>,data<span class="op">=</span><span class="va">colon</span>,nt<span class="op">=</span><span class="fl">3</span>,modele<span class="op">=</span><span class="st">"pls-beta"</span><span class="op">)</span>, sim<span class="op">=</span><span class="st">"ordinary"</span>, stype<span class="op">=</span><span class="st">"i"</span>, R<span class="op">=</span><span class="fl">250</span><span class="op">)</span></span>
<span><span class="co">#save(modpls.boot3,file="modpls.boot_nt3.Rdata")</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"modpls.boot_nt3"</span><span class="op">)</span></span>
<span><span class="va">temp.ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu">plsRglm</span><span class="fu">::</span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/confints.bootpls.html" class="external-link">confints.bootpls</a></span><span class="op">(</span><span class="va">modpls.boot3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ind_BCa_nt3</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">temp.ci</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">&amp;</span><span class="va">temp.ci</span><span class="op">[</span>,<span class="fl">8</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">|</span><span class="op">(</span><span class="va">temp.ci</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">&amp;</span><span class="va">temp.ci</span><span class="op">[</span>,<span class="fl">8</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#save(ind_BCa_nt3,file="ind_BCa_nt3.Rdata")</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/boxplots.bootpls.html" class="external-link">boxplots.bootpls</a></span><span class="op">(</span><span class="va">modpls.boot3</span>,indices <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-16-1.png" alt="Figure 5. Boxplots of the bootstrap distribution of the coefficients of the predictors, 3 components BR" width="480"><p class="caption">
Figure 5. Boxplots of the bootstrap distribution of the coefficients of
the predictors, 3 components BR
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plsRglm</span><span class="fu">::</span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/plots.confints.bootpls.html" class="external-link">plots.confints.bootpls</a></span><span class="op">(</span><span class="va">temp.ci</span>,prednames<span class="op">=</span><span class="cn">TRUE</span>,indices <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-17-1.png" alt="Figure 6. Bootstrap 95% confidence intervals, 3 components BR" width="480"><p class="caption">
Figure 6. Bootstrap 95% confidence intervals, 3 components BR
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"ind_BCa_nt3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">[</span><span class="va">ind_BCa_nt3</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "Intercept"   "X4.68499947" "X4.67499971" "X4.65499973" "X4.63499975"</span></span>
<span><span class="co">#&gt;  [6] "X4.52499962" "X4.51499987" "X4.50499964" "X4.45499992" "X4.43499947"</span></span>
<span><span class="co">#&gt; [11] "X4.42499971" "X4.41499949" "X4.38499975" "X4.37499952" "X4.35499954"</span></span>
<span><span class="co">#&gt; [16] "X4.23499966" "X4.2249999"  "X4.19499969" "X4.18499994" "X4.1449995" </span></span>
<span><span class="co">#&gt; [21] "X4.13499975" "X4.12499952" "X4.10499954" "X4.05499983" "X4.0449996" </span></span>
<span><span class="co">#&gt; [26] "X4.00499964" "X3.99499965" "X3.98499966" "X3.94499969" "X3.85499978"</span></span>
<span><span class="co">#&gt; [31] "X3.84499979" "X3.8349998"  "X3.82499981" "X3.80499983" "X3.75499964"</span></span>
<span><span class="co">#&gt; [36] "X3.73499966" "X3.67499971" "X3.65499973" "X3.64499974" "X3.59499979"</span></span>
<span><span class="co">#&gt; [41] "X3.56499982" "X3.54499984" "X3.53499961" "X3.52499962" "X3.51499963"</span></span>
<span><span class="co">#&gt; [46] "X3.50499964" "X3.49499965" "X3.48499966" "X3.46499968" "X3.44499969"</span></span>
<span><span class="co">#&gt; [51] "X3.4349997"  "X3.42499971" "X3.41499972" "X3.40499973" "X3.39499974"</span></span>
<span><span class="co">#&gt; [56] "X3.38499975" "X3.37499976" "X3.36499977" "X3.35499978" "X3.32499981"</span></span>
<span><span class="co">#&gt; [61] "X3.31499982" "X3.30499983" "X3.27499962" "X3.26499963" "X3.24499965"</span></span>
<span><span class="co">#&gt; [66] "X2.92499971" "X2.91499972"</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plsRglm</span><span class="fu">::</span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/plots.confints.bootpls.html" class="external-link">plots.confints.bootpls</a></span><span class="op">(</span><span class="va">temp.ci</span>,prednames<span class="op">=</span><span class="cn">TRUE</span>,indices <span class="op">=</span> <span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">ind_BCa_nt3</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,articlestyle<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-19-1.png" alt="Figure 7. Bootstrap 95% confidence intervals, BCa significant variables, 3 components BR." width="480"><p class="caption">
Figure 7. Bootstrap 95% confidence intervals, BCa significant variables,
3 components BR.
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plsRglm</span><span class="fu">::</span><span class="fu"><a href="https://fbertran.github.io/plsRglm/reference/plots.confints.bootpls.html" class="external-link">plots.confints.bootpls</a></span><span class="op">(</span><span class="va">temp.ci</span>,prednames<span class="op">=</span><span class="cn">TRUE</span>,indices <span class="op">=</span> <span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">temp.ci</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">ind_BCa_nt3</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,articlestyle<span class="op">=</span><span class="cn">FALSE</span>,typeIC<span class="op">=</span><span class="st">"BCa"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-20-1.png" alt="Figure 8. BCa Bootstrap 95% confidence intervals, BCa significant variables, 3 components BR." width="480"><p class="caption">
Figure 8. BCa Bootstrap 95% confidence intervals, BCa significant
variables, 3 components BR.
</p>
</div>
<p>Finally, we fit a Beta PLS regression model constructed from the only
79 significant predictors for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
bootstrap technique. The selection of the number of components, not
reproduced here due to lack of space, leads us to retain 2 of them.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ind_BCa_nt3"</span><span class="op">)</span></span>
<span><span class="va">colon_sub4</span> <span class="op">&lt;-</span> <span class="va">colon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="va">ind_BCa_nt3</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modpls_sub4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plsRbeta.html">plsRbeta</a></span><span class="op">(</span><span class="va">X..Cellules.tumorales</span><span class="op">~</span><span class="va">.</span>,data<span class="op">=</span><span class="va">colon_sub4</span>,nt<span class="op">=</span><span class="fl">10</span>,modele<span class="op">=</span><span class="st">"pls-beta"</span><span class="op">)</span></span>
<span><span class="co">#save(modpls_sub4,file="modpls_sub4.Rdata")</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"modpls_sub4"</span><span class="op">)</span></span>
<span><span class="va">modpls_sub4</span></span>
<span><span class="co">#&gt; Number of required components:</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; Number of successfully computed components:</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                     [,1]</span></span>
<span><span class="co">#&gt; Intercept      1.5448748</span></span>
<span><span class="co">#&gt; X4.65499973   61.1773419</span></span>
<span><span class="co">#&gt; X4.6449995   306.0463140</span></span>
<span><span class="co">#&gt; X4.63499975 -284.4099752</span></span>
<span><span class="co">#&gt; X4.60499954  130.5717258</span></span>
<span><span class="co">#&gt; X4.59499979   20.9463141</span></span>
<span><span class="co">#&gt; X4.58499956 -281.2770768</span></span>
<span><span class="co">#&gt; X4.57499981 -144.3983544</span></span>
<span><span class="co">#&gt; X4.56499958  641.2859589</span></span>
<span><span class="co">#&gt; X4.55499983  942.5579964</span></span>
<span><span class="co">#&gt; X4.52499962   72.6143880</span></span>
<span><span class="co">#&gt; X4.51499987 -251.4256475</span></span>
<span><span class="co">#&gt; X4.50499964  -10.2039878</span></span>
<span><span class="co">#&gt; X4.43499947 -138.0766836</span></span>
<span><span class="co">#&gt; X4.42499971 -880.1560188</span></span>
<span><span class="co">#&gt; X4.38499975 -941.1056739</span></span>
<span><span class="co">#&gt; X4.37499952 -784.5708620</span></span>
<span><span class="co">#&gt; X4.35499954  -68.8364717</span></span>
<span><span class="co">#&gt; X4.2949996   109.1380862</span></span>
<span><span class="co">#&gt; X4.28499985  289.5456254</span></span>
<span><span class="co">#&gt; X4.27499962 -322.5710004</span></span>
<span><span class="co">#&gt; X4.26499987   71.6963047</span></span>
<span><span class="co">#&gt; X4.25499964  304.2135548</span></span>
<span><span class="co">#&gt; X4.20499992  481.8986709</span></span>
<span><span class="co">#&gt; X4.19499969  663.7076930</span></span>
<span><span class="co">#&gt; X4.18499994   79.9407749</span></span>
<span><span class="co">#&gt; X4.1449995   -27.1338795</span></span>
<span><span class="co">#&gt; X4.13499975   -0.6603306</span></span>
<span><span class="co">#&gt; X4.12499952    5.0923295</span></span>
<span><span class="co">#&gt; X4.11499977   -6.9928171</span></span>
<span><span class="co">#&gt; X4.10499954    7.3648246</span></span>
<span><span class="co">#&gt; X4.09499979   86.6345576</span></span>
<span><span class="co">#&gt; X4.05499983  -20.4373561</span></span>
<span><span class="co">#&gt; X4.0449996  -132.2956632</span></span>
<span><span class="co">#&gt; X4.00499964   -0.6487794</span></span>
<span><span class="co">#&gt; X3.99499965  -28.7700528</span></span>
<span><span class="co">#&gt; X3.98499966  -11.1008973</span></span>
<span><span class="co">#&gt; X3.85499978  201.1209855</span></span>
<span><span class="co">#&gt; X3.84499979 -112.9491585</span></span>
<span><span class="co">#&gt; X3.8349998  -112.0879668</span></span>
<span><span class="co">#&gt; X3.82499981 -176.4575677</span></span>
<span><span class="co">#&gt; X3.81499982 -499.4286464</span></span>
<span><span class="co">#&gt; X3.80499983   96.0999755</span></span>
<span><span class="co">#&gt; X3.7949996  -130.6062827</span></span>
<span><span class="co">#&gt; X3.76499963    2.2957805</span></span>
<span><span class="co">#&gt; X3.75499964   73.7212553</span></span>
<span><span class="co">#&gt; X3.73499966  110.5824104</span></span>
<span><span class="co">#&gt; X3.70499969   -9.6116865</span></span>
<span><span class="co">#&gt; X3.69499969    6.8740870</span></span>
<span><span class="co">#&gt; X3.66499972   -0.9445308</span></span>
<span><span class="co">#&gt; X3.65499973    7.7458993</span></span>
<span><span class="co">#&gt; X3.61499977    7.1671863</span></span>
<span><span class="co">#&gt; X3.59499979  -73.7235407</span></span>
<span><span class="co">#&gt; X3.56499982  -37.2007473</span></span>
<span><span class="co">#&gt; X3.54499984   27.1867459</span></span>
<span><span class="co">#&gt; X3.53499961    9.9491250</span></span>
<span><span class="co">#&gt; X3.52499962   -1.4676426</span></span>
<span><span class="co">#&gt; X3.51499963 -185.4622429</span></span>
<span><span class="co">#&gt; X3.50499964  201.8383573</span></span>
<span><span class="co">#&gt; X3.49499965 -390.4445054</span></span>
<span><span class="co">#&gt; X3.48499966 -141.9592003</span></span>
<span><span class="co">#&gt; X3.47499967 -134.0444094</span></span>
<span><span class="co">#&gt; X3.46499968 -141.0216380</span></span>
<span><span class="co">#&gt; X3.44499969  227.1789740</span></span>
<span><span class="co">#&gt; X3.4349997    -4.7983899</span></span>
<span><span class="co">#&gt; X3.42499971  -79.9664654</span></span>
<span><span class="co">#&gt; X3.41499972   26.0378859</span></span>
<span><span class="co">#&gt; X3.40499973    7.7258949</span></span>
<span><span class="co">#&gt; X3.37499976 -628.0508174</span></span>
<span><span class="co">#&gt; X3.36499977 -505.0750367</span></span>
<span><span class="co">#&gt; X3.35499978  140.4448861</span></span>
<span><span class="co">#&gt; X3.32499981  259.3811778</span></span>
<span><span class="co">#&gt; X3.31499982 -276.7503657</span></span>
<span><span class="co">#&gt; X3.30499983  491.7257390</span></span>
<span><span class="co">#&gt; X3.27499962   37.4180261</span></span>
<span><span class="co">#&gt; X3.26499963   28.6326050</span></span>
<span><span class="co">#&gt; X3.25499964   16.3911723</span></span>
<span><span class="co">#&gt; X3.24499965   37.8061066</span></span>
<span><span class="co">#&gt; X3.19499969  -32.7055621</span></span>
<span><span class="co">#&gt; X3.13499975  256.5034605</span></span>
<span><span class="co">#&gt; Information criteria and Fit statistics:</span></span>
<span><span class="co">#&gt;                   AIC        BIC Chi2_Pearson_Y     RSS_Y pseudo_R2_Y      R2_Y</span></span>
<span><span class="co">#&gt; Nb_Comp_0   -32.34558  -27.58152       76.77937 6.4449550          NA        NA</span></span>
<span><span class="co">#&gt; Nb_Comp_1  -129.57972 -122.43364       79.47275 2.2942689   0.7755421 0.6440210</span></span>
<span><span class="co">#&gt; Nb_Comp_2  -134.63789 -125.10979       72.20098 1.9728198   0.7991522 0.6938970</span></span>
<span><span class="co">#&gt; Nb_Comp_3  -142.69157 -130.78143       79.01884 1.8772302   0.8279202 0.7087287</span></span>
<span><span class="co">#&gt; Nb_Comp_4  -155.51742 -141.22526       84.08689 1.5340918   0.8558543 0.7619701</span></span>
<span><span class="co">#&gt; Nb_Comp_5  -164.67721 -148.00302       79.11247 1.3100325   0.8743807 0.7967352</span></span>
<span><span class="co">#&gt; Nb_Comp_6  -169.31896 -150.26274       75.81459 1.1376671   0.8794340 0.8234794</span></span>
<span><span class="co">#&gt; Nb_Comp_7  -171.85756 -150.41932       75.94769 1.1110661   0.8924862 0.8276068</span></span>
<span><span class="co">#&gt; Nb_Comp_8  -176.91620 -153.09593       71.83334 0.9526869   0.8974669 0.8521810</span></span>
<span><span class="co">#&gt; Nb_Comp_9  -186.16095 -159.95866       72.24187 0.8050430   0.9039681 0.8750894</span></span>
<span><span class="co">#&gt; Nb_Comp_10 -190.25562 -161.67130       71.24851 0.7212852   0.9063458 0.8880853</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Index plot</span></span>
<span><span class="va">sfit</span> <span class="op">&lt;-</span> <span class="va">modpls_sub4</span><span class="op">$</span><span class="va">FinalModel</span>;</span>
<span><span class="va">rd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">sfit</span>, type<span class="op">=</span><span class="st">"sweighted2"</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">sfit</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>, <span class="va">rd</span>, xlab<span class="op">=</span><span class="st">"Subject Index"</span>, ylab<span class="op">=</span><span class="st">"Std Weigthed Resid 2"</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Index Plot"</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>;</span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/unnamed-chunk-24-1.png" alt="Figure 9. Residuals index plot." width="480"><p class="caption">
Figure 9. Residuals index plot.
</p>
</div>
<p>We note on Figure 10 that this model is validated by the use of a
simulated envelope (Atkinson, 1981)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;A.C. ATKINSON&lt;/em&gt;. Two graphical displays for
outlying and influential observations in regression. Biometrika,
68(1):13–20, 1981.&lt;/p&gt;"><sup>43</sup></a>. This one is constructed, as recommended
by Atkinson, from 19 order statistics.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://topmodels.R-Forge.R-project.org/betareg/" class="external-link">betareg</a></span><span class="op">)</span></span>
<span><span class="co"># A Half-normal Plot with simulated envelop</span></span>
<span><span class="va">phat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sfit</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>;</span>
<span><span class="va">phihat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sfit</span>, type<span class="op">=</span><span class="st">"precision"</span><span class="op">)</span>;</span>
<span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="va">modpls_sub4</span><span class="op">$</span><span class="va">tt</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">sfit</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="va">absrds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>;</span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>     <span class="va">tYwotNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">sfit</span><span class="op">$</span><span class="va">n</span>, <span class="va">phat</span><span class="op">*</span><span class="va">phihat</span>, <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">phat</span><span class="op">)</span><span class="op">*</span><span class="va">phihat</span><span class="op">)</span>;</span>
<span>     <span class="va">tsfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html" class="external-link">betareg</a></span><span class="op">(</span><span class="va">tYwotNA</span><span class="op">~</span><span class="va">tt</span>, x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span>
<span>     <span class="va">trd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">tsfit</span>, type<span class="op">=</span><span class="st">"sweighted2"</span><span class="op">)</span>;</span>
<span>     <span class="va">absrds</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">trd</span><span class="op">)</span><span class="op">)</span>;</span>
<span>  <span class="op">}</span></span>
<span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">middle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>;</span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="va">min</span> <span class="op">&lt;-</span> <span class="va">max</span> <span class="op">&lt;-</span> <span class="va">sum</span> <span class="op">&lt;-</span> <span class="va">absrds</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>;</span>
<span>   <span class="va">min</span>; <span class="va">max</span>;</span>
<span>   <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">min</span> <span class="op">&gt;</span> <span class="va">absrds</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="va">min</span> <span class="op">&lt;-</span> <span class="va">absrds</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>;</span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">max</span> <span class="op">&lt;</span> <span class="va">absrds</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="va">max</span> <span class="op">&lt;-</span> <span class="va">absrds</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>;</span>
<span>      <span class="va">sum</span> <span class="op">&lt;-</span> <span class="va">sum</span> <span class="op">+</span> <span class="va">absrds</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>;</span>
<span>   <span class="op">}</span></span>
<span>   <span class="va">lower</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">min</span>;</span>
<span>   <span class="va">upper</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">max</span>;</span>
<span>   <span class="va">middle</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sum</span> <span class="op">/</span> <span class="fl">19</span>;</span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">qnval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">+</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">qnval</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rd</span><span class="op">)</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3.5</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Expected"</span>, ylab<span class="op">=</span><span class="st">"Observed"</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Half-Normal Plot with Simulated Envelope"</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">qnval</span>, <span class="va">lower</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">qnval</span>, <span class="va">upper</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">qnval</span>, <span class="va">middle</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>;</span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/simulated_envelope_submod4-1.png" alt="Figure 10. Residuals and simulated envelop." width="480"><p class="caption">
Figure 10. Residuals and simulated envelop.
</p>
</div>
<p>As we can see in Figure 11, the two components of the model formed by
the only 79 significant predictors for the bootstrap technique
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>C</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">BC_a</annotation></semantics></math>
allow a clear linear separation between the healthy subjects, in dark
green, and the sick subjects whose condition is all the more serious as
the color approaches red. To allow a graphical evaluation of the
predictive quality of the model, we represent the observed values as a
function of the predicted values on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">logit</mtext><annotation encoding="application/x-tex">\textrm{logit}</annotation></semantics></math>
scale, Figure 12, and on the original scale Figure 13. Note that, since
the transition from one to the other of the two graphs is done by means
of a continuous, bijective and increasing transformation of the axes,
the Kendall correlation coefficient between the observed and predicted
values will be identical for both scales. For both graphs, we measure an
association in the sense of Kendall’s correlation coefficient between
the observed values and the predicted values equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.72</mn><annotation encoding="application/x-tex">0.72</annotation></semantics></math>
for a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7.03</mn><mo>*</mo><msup><mn>10</mn><mrow><mi>−</mi><mn>19</mn></mrow></msup></mrow><annotation encoding="application/x-tex">7.03*10^{-19}</annotation></semantics></math>,
thus significant at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">1\%</annotation></semantics></math>
threshold.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modpls_sub4</span><span class="op">$</span><span class="va">tt</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">modpls_sub4</span><span class="op">$</span><span class="va">tt</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,col<span class="op">=</span><span class="fu">plotrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/color.scale.html" class="external-link">color.scale</a></span><span class="op">(</span><span class="va">colon</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">16</span>,ylab<span class="op">=</span><span class="st">""</span>,xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/mod_sub4_nt2_12_beta-1.png" alt="Figure 11. Representation of individuals on the plane formed by the first two components." width="480"><p class="caption">
Figure 11. Representation of individuals on the plane formed by the
first two components.
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">linkfun</span><span class="op">(</span><span class="va">modpls_sub4</span><span class="op">$</span><span class="va">ValsPredictY</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">linkfun</span><span class="op">(</span><span class="va">orig</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"Valeurs prédites"</span>,ylab<span class="op">=</span><span class="st">"Valeurs observées"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/plot_logit_xpred_yorig_submod4-1.png" alt="Figure 12. Observed values versus predicted values on the logit scale." width="480"><p class="caption">
Figure 12. Observed values versus predicted values on the logit scale.
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modpls_sub4</span><span class="op">$</span><span class="va">ValsPredictY</span>,<span class="va">orig</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="tn_Insights_files/figure-html/plot_xpred_yorig_submod4-1.png" alt="Figure 13. Observed values versus predicted values on the original scale." width="480"><p class="caption">
Figure 13. Observed values versus predicted values on the original
scale.
</p>
</div>
<p>Note, however, that the data in this example are in fact formed by
mixing healthy individuals for whom the infiltration rate is zero and
sick individuals for whom these rates are non-zero and vary from 0 to 1.
Thus the use of a PLS regression model based on the combination of a
logistic PLS regression model and a Beta logistic regression model or a
Beta regression model with inflation of 0 introduced by Ospina and
Ferrari (Ospina, 2012)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;em&gt;R. OSPINA et SLP. FERRARI&lt;/em&gt;. A general class of
zero-or-one inflated beta regression models. Computational Statistics
&amp;amp; Data Analysis, 56(1):1609–1623, 2012.&lt;/p&gt;"><sup>44</sup></a> would likely make sense and is currently
being carried out by the authors.</p>
</div>
<div class="section level2">
<h2 id="conclusion-and-perspectives">Conclusion and perspectives<a class="anchor" aria-label="anchor" href="#conclusion-and-perspectives"></a>
</h2>
<p>Our goal has been to propose an extension of PLS regression to Beta
regression models, and then to make it available to users of the free
language <code>R</code>.</p>
<p>We thus offer the possibility to work with collinear predictors to
model rates or proportions, which is an unavoidable difficulty when
modeling mixtures or when analyzing spectra or studying genetic,
proteomic or metabonomic data.</p>
<p>Moreover, Beta PLS regression can also be applied to incomplete data
sets. It is also possible in this case, as in the case of complete data,
to select the number of components by repeated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-fold
cross-validation.</p>
<p>Finally, we propose bootstrap techniques in order to, for example,
test the significance of each of the predictors present in the dataset
and thus validate the models built.</p>
<p>The study of two real datasets allowed the proposed tools to
demonstrate their efficiency.</p>
<div class="section level3">
<h3 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h3>
<p>The authors are grateful to the two referees for their comments and
suggestions which helped to improve the quality of several points of the
article as well as to Jean-Pierre Gauchi for his availability and his
pertinent and constructive remarks.</p>
<p><br><br><br></p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Frederic Bertrand, Myriam Maumy-Bertrand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
